plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
# Pintamos un ejemplo
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
# Pintamos un ejemplo
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
# Crea un poligono mancha con algoritmo st_convex_hull
mancha2<-function(simplicidad=3,xmax=10,ymax=20){
a=0
while(a <50){ # esto es para evitar manchas muy chicas
# defino la extension del lienzo
x<-runif(20)*xmax # limites x
y<-runif(20)*ymax  # limite Y
# xy aleatorio
xy<-data.frame(x=x,y=y)
# Convertimos a sf
xy_sf <- st_as_sf(xy, coords = c("x", "y"))
#creamos un poligono convexo
poly<-st_convex_hull(st_union(xy_sf)) %>% st_cast("POINT")  %>% st_coordinates()
# añadimos caos a los lados
manch<-div_pol_n(poly,simplicidad)
#hacemos la simetrica
manchsim<-data.frame(x=-manch$x,y=manch$y)
#convertimos a sf la mancha y su simetrica
xy1 <- st_as_sf(manch, coords = c("x", "y"))
xy11<-pol_to_sf(xy1)
xy2 <- st_as_sf(manchsim, coords = c("x", "y"))
xy21<-pol_to_sf(xy2)
# unimos ambas con un buffer
z<-st_union(st_buffer(xy11,0.2),st_buffer(xy21,0.2))
a<- unclass(st_area(z)) # calcula el area
}
return(z)
}
# generamos un par de manchas de ejemplo
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
p<-mancha2(simplicidad=runif(1,2,4),xmax=runif(1,5,10),ymax=runif(1,10,20))
plot(st_geometry(p),col=gray(0.1))
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
p<-mancha1(simplicidad=runif(1,4,7),des=runif(1,15,35))
# esto es para simplificar la forma
# q<-st_simplify(p,preserveTopology = TRUE, dTolerance = 1)
plot(st_geometry(p),col=gray(0.1))
plot(st_geometry(st_buffer(p,0.2)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,0.5)),border=gray(0.1),add=T)
plot(st_geometry(st_buffer(p,-0.2)),border=gray(0.91),add=T)
plot(st_geometry(st_buffer(p,-0.5)),border=gray(0.91),add=T)
blogdown:::insert_image_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
library(GENLIB)
install.packages("GENLIB")
library(GENLIB)
ind<-c(1,2,3,11:21,101:108,201:202)
father<-c(11,15,15,102,0,102,0,103,103,0,105,105,107,107,0,202,0,202,202,0,202,0,0,0)
mother<-c(12,14,14,101,0,101,0,104,104,0,106,106,108,108,0,201,0,201,201,0,201,0,0,0)
sex<-c(1,2,2,1,2,1,2,1,2,1,2,2,2,1,2,1,1,2,1,2,1,2,2,1)
gen.df<-data.frame(ind, father, mother, sex)
genEx<-gen.genealogy(gen.df)
gen.graph(genEx)
gen.genout( genEx)
data(geneaJi)
geneaJi[1:5,]
genJi<-gen.genealogy(geneaJi)
gen.graph(genJi)
gen.graph(familia)
library(DiagrammeR)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Pedro-Esperanza)-->15[Antoniop-M?Luisa];
1-->3[Josefina];
1-->10[Manolo-Paquita];
1-->6[Pepe-M?Carmen];
6-->19[Fernando-Eva];
6-->8(Mamen);
6-->9(Cristina);
10-->11(Raquel);
10-->12(Elena);
10-->13(Manolo);
10-->14(Paco);
15-->16(Guillermo);
15-->17(Susana);
15-->18(Antonio);
19-->20(Guillermo);
19-->21(Marina);
19-->22(Eva);
19-->23(Sofia);
24(JoseAntonio-M?Dolores)-->19;
24(JoseAntonio-M?Dolores)-->25(Dolo);
25-->26(Olga);
9-->27[Cristina-Santiago];
28(Pascual-Dolores)-->24
29(Fernando-Encarnacion)-->6
29-->30[Fernando]
29-->31[Luismiguel]
style 1 fill:#E5E25F;
style 6 fill:#81F7BE;
style 19 fill:#FAAC58;
style 29 fill:#FA58F4
"
)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Pedro-Esperanza)-->15[Antoniop-M?Luisa];
1-->3[Josefina];
1-->10[Manolo-Paquita];
1-->6[Pepe-M?Carmen];
style 1 fill:#E5E25F;
style 6 fill:#81F7BE;
style 19 fill:#FAAC58;
style 29 fill:#FA58F4
"
)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Yaya-Yayo)-->15[Papá-Mamá];
1-->3[Tía Jose];
1-->10[Tío Manolo-Paquita];
1-->6[Tío Pepe-Carmen];
style 1 fill:#E5E25F;
style 6 fill:#81F7BE;
style 19 fill:#FAAC58;
style 29 fill:#FA58F4
"
)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Yaya-Yayo)-->15[Papá-Mamá];
1-->3[Tía Jose];
1-->10[Tío Manolo-Paquita];
1-->6[Tío Pepe-Carmen];
15-->16[Yo-Tú]
16-->18[hijo1]
16-->19[hijo2]
style 1 fill:#E5E25F;
style 6 fill:#81F7BE;
style 19 fill:#FAAC58;
style 29 fill:#FA58F4
"
)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Yaya-Yayo)-->15[Papá-Mamá];
1-->3[Tía A];
1-->10[Tío B-B1];
1-->6[Tío C-C1];
15-->16[Yo-Tú]
16-->18[hijo1]
16-->19[hijo2]
style 1 fill:#E5E25F;
style 6 fill:#81F7BE;
style 19 fill:#FAAC58;
style 16 fill:#FA58F4
"
)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Yaya-Yayo)-->15[Papá-Mamá];
1-->3[Tía A];
1-->10[Tío B-B1];
1-->6[Tío C-C1];
15-->16[Yo-Tú]
16-->18[hijo1]
16-->19[hijo2]
style 1 fill:#E5E25F;
style 15 fill:#81F7BE;
style 19 fill:#FAAC58;
style 16 fill:#FA58F4
"
)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Yaya-Yayo)-->15[Papá-Mamá];
1-->3[Tía A];
1-->10[Tío B-B1];
1-->6[Tío C-C1];
15-->16[Yo-Tú]
16-->18[hijo1]
16-->19[hijo2]
#opciones de estilo
style 1 fill:#E5E25F;
style 15 fill:#81F7BE;
style 19 fill:#FAAC58;
style 16 fill:#FA58F4
"
)
# arbol genealógico sencillo
DiagrammeR("graph TD;
1(Yaya-Yayo)-->15[Papá-Mamá];
1-->3[Tía A];
1-->10[Tío B-B1];
1-->6[Tío C-C1];
15-->16[Yo-Tú]
16-->18[hijo1]
16-->19[hijo2]
style 1 fill:#E5E25F;
style 15 fill:#81F7BE;
style 19 fill:#FAAC58;
style 16 fill:#FA58F4
"
)
familia<-data.frame(stringsAsFactors=FALSE,
ind = c(1, 2, 3, 6, 5, 4, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 100,
102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124,
126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150,
152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174),
father = c(126, 128, 1, 1, 1, 1, 3, 3, 0, 4, 0, 0, 10, 10, 10, 10, 126,
0, 126, 126, 0, 128, 128, 3, 0, 116, 116, 116, 116, 0, 0, 0,
7, 7, 0, 136, 136, 0, 8, 8, 8, 0, 150, 150, 0, 156, 156, 0, 122,
122, 0, 0, 4, 4),
mother = c(102, 108, 2, 2, 2, 2, 9, 9, 0, 11, 0, 0, 12, 12, 12, 12, 102,
0, 102, 102, 0, 108, 108, 9, 0, 5, 5, 5, 5, 0, 0, 0, 130, 130,
0, 114, 114, 0, 142, 142, 142, 0, 118, 118, 0, 120, 120, 0,
162, 162, 0, 0, 11, 11),
sex = c(1, 2, 1, 2, 2, 1, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2,
1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 1,
2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 2, 2),
nom = c("Pedro", "Espe", "Antonio", "Josefina", "Paquita", "Pepe",
"Guillermo", "Antonio", "M_Luisa", "Fer", "M_Carmen", "Eva",
"Guillermo", "Marina", "Eva", "Sofia", "Antonio", "Josefa",
"Pascual", "Juana", "Francisca", "Pepe", "Ramon", "Susana", "Manolo",
"Raquel", "Elena", "Manolo", "Paco", "Antonio", "Cristobal",
"M_Jose", "Laura", "Jaime", NA, "Nicolas", "Julieta", "Ana",
"Sara", "Javier", "Diego", "Pepe", "Beatriz", "Jose", "Antonio",
"Santiago", "David", "Tati", "Pablo", "Alba", "Juan", "Santiago",
"Mamen", "Cristina"),
status = c(1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
)
head(familia)
tail(familia)
fam1<-pedigree(id=familia$ind,
dadid = familia$father,
momid = familia$mother,
sex = familia$sex,
status = familia$status)
###
library(kinship2)
fam1<-pedigree(id=familia$ind,
dadid = familia$father,
momid = familia$mother,
sex = familia$sex,
status = familia$status)
# plot.pedigree {kinship2}
plot(fam1)
plot(fam2)
fam2<-pedigree(id=familia$ind,
dadid = familia$father,
momid = familia$mother,
sex = familia$sex,
status = familia$status,
relation=relaciones)
fam2<-pedigree(id=familia$ind,
dadid = familia$father,
momid = familia$mother,
sex = familia$sex,
status = familia$status)
plot(fam2)
id2 <- paste( familia$nom,fam2$id,sep="\n")
plot(fam2, id=id2,symbolsize=1,cex=0.8)
plot(fam2)
id2 <- paste( familia$nom,fam2$id,sep="\n")
plot(fam2, id=id2,symbolsize=1,cex=0.8)
# pintamos ocn colores
plot(fam2, col=ifelse(familia$sex==1,1,2), id=id2,cex=0.8)
relate2 <- matrix(c(210,211,1,212,213,3), nrow=2, byrow=TRUE)
kin2 <- kinship(fam1)
toLatex(sessionInfo())
gen.df<-data.frame(familia$ind, familia$father, familia$mother, familia$sex-1)
genEx<-gen.genealogy(familia)
gen.graph(genEx)
print(pedAll)
gen.graph(genEx)
gen.graph(genEx)
kin2 <- kinship(ped2basic)
ped2 <- pedigree(df2$id, df2$father, df2$mother, + df2$sex, status=df2$censor)
df2 <- sample.ped[sample.ped$ped==2,]
names(df2)
df2$censor <- c(1,1, rep(0, 12))
ped2 <- pedigree(df2$id, df2$father, df2$mother, + df2$sex, status=df2$censor)
gen.graph(ped2)
kin2 <- kinship(fam1)
kin2
familia<-data.frame(stringsAsFactors=FALSE,
ind = c(1, 2, 3, 6, 5, 4, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 100,
102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124,
126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150,
152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174),
father = c(126, 128, 1, 1, 1, 1, 3, 3, 0, 4, 0, 0, 10, 10, 10, 10, 126,
0, 126, 126, 0, 128, 128, 3, 0, 116, 116, 116, 116, 0, 0, 0,
7, 7, 0, 136, 136, 0, 8, 8, 8, 0, 150, 150, 0, 156, 156, 0, 122,
122, 0, 0, 4, 4),
mother = c(102, 108, 2, 2, 2, 2, 9, 9, 0, 11, 0, 0, 12, 12, 12, 12, 102,
0, 102, 102, 0, 108, 108, 9, 0, 5, 5, 5, 5, 0, 0, 0, 130, 130,
0, 114, 114, 0, 142, 142, 142, 0, 118, 118, 0, 120, 120, 0,
162, 162, 0, 0, 11, 11),
sex = c(1, 2, 1, 2, 2, 1, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2,
1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 1,
2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 2, 2),
nom = c("Pedro", "María", "Antonio", "Eva", "Ruth", "Santiago",
"Javier", "Fernando", "M_Luisa", "Angel", "M_Carmen", "Eva",
"Jaime", "Mar", "Eva", "Ana", "Antonio", "Josefa",
"Pascual", "Juana", "Francisca", "Pepe", "Ramon", "Susana", "Manolo",
"Raquel", "Javier", "Manolo", "Paco", "Antonio", "Cristobal",
"M_Jose", "Laura", "Jaime", NA, "Nicolas", "Julieta", "Ana",
"Sara", "Javier", "Diego", "Pepe", "Beatriz", "Jose", "Antonio",
"Santiago", "David", "Ana", "Angel", "Alba", "Juan", "Santiago",
"Malen", "Cristina"),
status = c(1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
)
# ojo va con ; en lugar de comas
#familia<-read.csv("familia1.csv",sep = ";",header = T)
#head(familia)
#tail(familia)
fam1<-pedigree(id=familia$ind,
dadid = familia$father,
momid = familia$mother,
sex = familia$sex,
status = familia$status)
# plot.pedigree {kinship2}
plot(fam1)
#pintamos lo nombres
id2 <- paste(fam1$id, familia$nom,sep="\n")
plot(fam1, id=id2,symbolsize=1,cex=0.8)
pedigree.legend(fam1, location="topright", radius=.3)
# ñadimos colores según sexo
plot(fam1, col=ifelse(familia$sex==1,1,2), id=id2,cex=0.8)
pedigree.legend(fam1, location="topright", radius=.3)
# formamos la tabla
gen.df<-data.frame(familia$ind, familia$father, familia$mother, familia$sex-1)
# cramos genealogía
genEx<-gen.genealogy(familia)
# Pintamos grafica
gen.graph(genEx)
familia<-data.frame(stringsAsFactors=FALSE,
ind = c(1, 2, 3, 6, 5, 4, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 100,
102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124,
126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150,
152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174),
father = c(126, 128, 1, 1, 1, 1, 3, 3, 0, 4, 0, 0, 10, 10, 10, 10, 126,
0, 126, 126, 0, 128, 128, 3, 0, 116, 116, 116, 116, 0, 0, 0,
7, 7, 0, 136, 136, 0, 8, 8, 8, 0, 150, 150, 0, 156, 156, 0, 122,
122, 0, 0, 4, 4),
mother = c(102, 108, 2, 2, 2, 2, 9, 9, 0, 11, 0, 0, 12, 12, 12, 12, 102,
0, 102, 102, 0, 108, 108, 9, 0, 5, 5, 5, 5, 0, 0, 0, 130, 130,
0, 114, 114, 0, 142, 142, 142, 0, 118, 118, 0, 120, 120, 0,
162, 162, 0, 0, 11, 11),
sex = c(1, 2, 1, 2, 2, 1, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2,
1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 1,
2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 2, 2),
nom = c("Pedro", "María", "Antonio", "Eva", "Ruth", "Santiago",
"Javier", "Fernando", "M_Luisa", "Angel", "M_Carmen", "Eva",
"Jaime", "Mar", "Eva", "Ana", "Antonio", "Josefa",
"Pascual", "Juana", "Francisca", "Pepe", "Ramon", "Susana", "Manolo",
"Raquel", "Javier", "Manolo", "Paco", "Antonio", "Cristobal",
"M_Jose", "Laura", "Jaime", NA, "Nicolas", "Julieta", "Ana",
"Sara", "Javier", "Diego", "Pepe", "Beatriz", "Jose", "Antonio",
"Santiago", "David", "Ana", "Angel", "Alba", "Juan", "Santiago",
"Malen", "Cristina"),
status = c(1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
)
head(familia)
library(knitr)
library(kableExtra)
kable(head(familia),"html")
kable(head(familia),"html",booktabs=T)
library(kinship2)
# creamos las relaciones
fam1<-pedigree(id=familia$ind,
dadid = familia$father,
momid = familia$mother,
sex = familia$sex,
status = familia$status)
#Pintamos el árbol genealigico
#plot.pedigree {kinship2}
plot(fam1)
blogdown:::serve_site()
blogdown:::insert_image_addin()
blogdown:::serve_site()
