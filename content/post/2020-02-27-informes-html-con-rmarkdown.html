---
title: informes html con Rmarkdown
author: F.VilBer
date: '2020-02-27'
slug: informes-html-con-rmarkdown
draft: true
categories:
  - diseño
  - editar documentos
  - markdown
  - R
tags:
  - sintaxis
  - markdown
description: ''
thumbnail: ''
---



<p>Hace tiempo que quería escribir un resumen de trucos o ayudas rápidas para hacer informes en formato web (HTML) usando RSTUDIO con Rmarkdown. No se trata de explicar <em>Rmarkdown</em>, para eso hay cientos de manuales muy completos como <a href="https://bookdown.org/yihui/rmarkdown/html-document.html">este</a>, solo dar algunas pinceladas de cosas que a mi me resultan útiles en los informes.</p>
<p>¡Vamos con materia!</p>
<div id="formato-yaml" class="section level2">
<h2>Formato YAML</h2>
<p>Siempre que empezamos un documento <em>Rmarkdown</em> nuevo, el formato general y el tipo de salida la definimos con el encabezado <em>YAML</em>. Aquí las opciones son muchísimas, ten en cuenta que con Rmarkdown puedes hacer muchos tipos de <a href="https://rmarkdown.rstudio.com/formats.html">salidas diferentes</a>{:target=“_blank&quot; rel=“noopener”} (pdf, html, presentaciones, páginas web, libros, websites, ODT…).</p>
<div class="figure">
<img src="/post/2020-02-27-informes-html-con-rmarkdown_files/rmarkdown_elementos.png" alt="markdown proceso" />
<p class="caption">markdown proceso</p>
</div>
<p>Si nos centramos en el tipo HTML, lo que hacemos es elegir como salida <code>output:</code> el formato <code>html_document:</code>. A partir de aquí, definimos en el metadata del <em>YAML</em> las características generales. Las voy comentando en el código siguiente, pues son muchas y lo normal es poner solo las que quieras y comentar con <code>#</code> o borrar el resto de líneas:</p>
<pre class="markdown"><code>---
title: &#39;informe HTML&#39;
author: &#39;Autor: Ferran&#39;
subtitle: &#39;qué grande es R&#39; 
date: 
output: 
  html_document:          # la salida predefinida es html 
# ver/ocultar los trozos de código  
    #code_download: true  # si incluimos un botón para bajar el código o no
    #code_folding: hide   # para mostrar o esconder los chunk de codigo 
# tabla de contenido
    #number_sections: yes   # numera los titulos
    toc: TRUE               # incluye o no el indice
    toc_float: TRUE         # incluye o no indice flotante
      #collapsed: false      # que se escondan los tit
      #smooth_scroll: false  # scroll en TOC
# formato  estilo    
    theme: &quot;spacelab&quot;    # especifica el tema Bootstrap
    highlight: kate      # resaltado de sintaxis
    #self_contained: false    # salida fichero autocontenido
# formato de figuras
    fig_width: 7         # ancho de las figuras por defecto
    fig_height: 6        # alto de las figuras
    fig_caption: true    # titulo de figura
---</code></pre>
<p>El formato general se da con las opciones <code>theme:</code> y <code>highlight:</code> que aportan la apariencia final y el resaltado de sintaxis. Ambas provienen de una librería libre de estilos llamada <em>Bootstrap</em>. Los estilos incluidos por defecto son los siguientes:</p>
<ul>
<li><code>theme:</code> default, cerulean, journal, flatly, darkly, readable, spacelab, united, cosmo, lumen, paper, sandstone, simplex, yeti</li>
<li><code>highlight:</code> default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, breezedark, textmate</li>
</ul>
<p>Para usar un estilo propio hay que dar la ruta (local) del fichero de estilo <code>css: fichero_estilo_propio.css</code> y poner a <code>null</code> ambas características anteriores.</p>
<p>Por defecto RMarkdown crea un unico fichero de salida que guarda internamiente todo (incluido imágenes..) esto no es el formato habitual de un HTML, y en algún caso si quieres guardar los links a los origenes de documentos (imagenes, videos etc..) quizás es mejor que uses <code>self_contained: false</code>, pero acuerdate que en este caso no solo debes mandar el fichero <em>html</em>, sino todas las dependencias. Incluso al usar esto , algunas librerías de formato como Bootstrap, y MathJax no se guardan en el fichero unico ya que ocupan mucho espacio. Si las quieres incluir hay que guardarlas en local para lo que se puede añadir <code>lib_dir: libs</code> y guardar en la carpeta <em>libs</em> las dependiencias.</p>
</div>
<div id="quitar-mensajes-de-innecesarios" class="section level2">
<h2>quitar mensajes de innecesarios</h2>
<p>Siempre es mejor poner una par de lineas de código para evitar llenar el informe de salidas innecesaias, como avisos, mensajes de error, y esas cosas. Basta con añadir debajo del encabezado YAML esto:</p>
<pre class="markdown"><code>```r &#39;{r setup, include=FALSE}&#39;` 
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```</code></pre>
</div>
<div id="insertar-imágenes" class="section level2">
<h2>Insertar imágenes</h2>
<p>Insertar una imágen en markdown es fácil, basta con incluir un código así:</p>
<pre class="markdown"><code>![titulo imagen](/ruta/a_la/imagen.jpg)</code></pre>
<p>Si quieres un formato mas completo en la salida debes usar código R. En mi caso uso mucho la función <code>include_graphics()</code> de la librería <code>knitr</code>, ya que da más opciones, por ejemplo así:</p>
<pre class="markdown"><code>```{r pressure, echo=FALSE, fig.cap=&quot;A caption&quot;, out.width = &quot;100%&quot; }
knitr::include_graphics(&quot;temp.png&quot;)
```</code></pre>
<p>La ventaja es que puedes controlar el tamaño de la imganen simplemente con el porcentaje. Si quieras insertar 2 fotos por línea solo tienes que poner en el inicio del chunk <code>out.width = '50%'</code>.</p>
<p>Y como metes código puedes hacer cosas como leer un directorio completo donde has dejado las imagenes y buscar algunas para sacarlas en el informe, por ejemplo así:</p>
<pre class="r"><code>  library(knitr)
    ruta&lt;-&quot;img/&quot;  # meto la ruta del directorio
    # busco en ese dir imagenes jpg..
    imagenes&lt;-list.files(ruta, pattern = &quot;.jpg&quot;, full.names = TRUE )
    
    #list.files(&quot;img/&quot;, pattern = &quot;*[0-9].jpg&quot;, full.names = TRUE ) # las que terminan en número
    # las imprimo o saco en el doc final
    include_graphics(imagenes)</code></pre>
<p>Otra opcion diferente es escribir código html directamente, ya que markdown lo reconoce, así si escibes esto, sale la imagen siguiente:</p>
<pre class="yaml"><code>&lt;div id=&quot;bg&quot;&gt;
  &lt;img src=&quot;/img/vis_art/predictions - sillas.jpg&quot; alt=&quot;&quot;&gt;
&lt;/div&gt; </code></pre>
<div id="bg">
<p><img src="/img/vis_art/predictions - sillas.jpg" alt=""></p>
</div>
</div>
<div id="insertar-imagene-en-el-header" class="section level2">
<h2>insertar imagene en el header</h2>
<p>Esto es una curiosidad, pero a mi me gusta poner un logo o imagen al inicio del informe, o de encabezado. Hay varias formas de hacerlo pero la más sencilla es así, poniendo este script</p>
<pre class="yaml"><code>&lt;script&gt;
   $(document).ready(function() {
     $head = $(&#39;#header&#39;);
     $head.prepend(&#39;&lt;img src=\&quot;LogoenRdados48.png\&quot; style=\&quot;float: right;width: 150px;\&quot;/&gt;&#39;)
   });
&lt;/script&gt;</code></pre>
<p>o incluyendo un head</p>
<pre class="yaml"><code>---
title: &quot;Test&quot;
author: &quot;Martin Schmelzer&quot;
date: &quot;13 Juli 2016&quot;
output: 
  html_document:
    includes:
      in_header: encabezado.html
---</code></pre>
</div>
<div id="insertar-tablas" class="section level2">
<h2>insertar tablas</h2>
<pre class="r"><code>knitr::kable(mtcars[1:5,, 1:5], caption = &quot;A table caption&quot;)</code></pre>
<pre><code>## Warning in if (drop) {: la condición tiene longitud &gt; 1 y sólo el primer
## elemento será usado</code></pre>
<table>
<caption><span id="tab:table">Table 1: </span>A table caption</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Para dar formatos a las tablas podemos usar tambien la extensión <code>kableExtra</code>.</p>
<pre class="markdown"><code>## pestañas {.tabset}

Algo muy util es usar pestañas.

### tabla

```{r}
knitr::kable(mtcars[1:5,, 1:5], caption = &quot;A table caption&quot;)
```
### Gráficos

```{r}
hist(rnorm(125), col=&quot;red&quot;)
```</code></pre>
</div>
<div id="conclusiones" class="section level2">
<h2>conclusiones</h2>
<p>estoi es el fin por hoy</p>
</div>
