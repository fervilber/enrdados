---
title: 'Leaflet mapas dinamicos '
author: F.VilBer
date: '2019-03-14'
slug: leaflet-mapas-dinamicos
categories:
  - mapas
  - GIS
  - R
tags:
  - CRS
  - mapas
  - R
  - sf
  - SIG
description: 'Como hacer mapas dinámicos con Leaflet y R'
thumbnail: '/post/2019-03-14-leaflet-mapas-dinamicos_files/leafletp.png'
toc: no
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="/rmarkdown-libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>
<script src="/rmarkdown-libs/leaflet-providers/leaflet-providers.js"></script>
<script src="/rmarkdown-libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
<link href="/rmarkdown-libs/leaflet-measure/leaflet-measure.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-measure/leaflet-measure.min.js"></script>
<script src="/rmarkdown-libs/fuse_js/fuse_js-prod.js"></script>
<link href="/rmarkdown-libs/lfx-search/lfx-search-prod.css" rel="stylesheet" />
<script src="/rmarkdown-libs/lfx-search/lfx-search-prod.js"></script>
<script src="/rmarkdown-libs/lfx-search/lfx-search-bindings.js"></script>


<div id="indice" class="section level2">
<h2>Indice</h2>
<ul>
<li><a href="#leaflet">Leaflet</a></li>
<li><a href="#primeros-pasos">Primeros pasos</a></li>
<li><a href="#cargar-capas-en-el-mapa">Cargar capas en el mapa</a></li>
<li><a href="#a%C3%B1adir-capas-shp-y-kml">Añadir capas shp y kml</a></li>
<li><a href="#mapview">mapview</a></li>
<li><a href="#opciones-de-personalizacion">Opciones de personalización</a></li>
<li><a href="#capa-base">Capa base</a></li>
<li><a href="#a%C3%B1adir-grupos">Añadir grupos</a></li>
<li><a href="#opciones">Otras opciones zoom etc</a></li>
<li><a href="#popups">popups</a></li>
<li><a href="#colores">Colores</a></li>
<li><a href="#leaflet.extras">leaflet.extras</a></li>
</ul>
</div>
<div id="leaflet" class="section level2">
<h2>Leaflet</h2>
<p><em>Leaflet</em> es indiscutiblemente el lider de las librerías de código abierto para la creación de <strong>mapas dinámicos</strong> libres. Está escrita en <em>JavaScript</em> y por tanto pensada para internet desde sus entrañas.</p>
<p>Esta maravilla de código se puede acceder y gestionar desde R con la librería <em>library(leaflet)</em> de manera super simple y al complementarse con R tenemos enormes posibilidades de creacción.</p>
</div>
<div id="primeros-pasos" class="section level2">
<h2>Primeros pasos</h2>
<p>Hacer un plano con <em>leaflet</em> es muy fácil:</p>
<ol style="list-style-type: decimal">
<li>cargar la librería: <code>leaflet()</code></li>
<li>llamar a la función que carga la capa base: <code>addTiles()</code></li>
</ol>
<p>Una nota previa, <em>leaflet</em> hace uso intensivo de la función tubería (<em>pipe</em> in english), por lo que es conveniente que sepas de qué va el símbolo <em>%&gt;%</em> de los paquetes <em>dplyr</em> o <em>tidyverse</em>.</p>
<pre class="r"><code>    # para instalar leaflet:    
    #   install.packages(&quot;leaflet&quot;)
    
    # Cargamos el paquete    
      library(leaflet)
    # carga del plano base
      leaflet()  %&gt;%  addTiles() </code></pre>
<div id="htmlwidget-1" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]}]},"evals":[],"jsHooks":[]}</script>
<p>A partir de aquí todo consiste en añadir funciones de carga de capas o funciones que personalizan la forma de visualizar el mapa o las capas.</p>
<p><a href="#indice">Volver al índice</a></p>
</div>
<div id="cargar-capas-en-el-mapa" class="section level2">
<h2>Cargar capas en el mapa</h2>
<p>Vamos explicar cómo visualizar datos en un mapa. Los más sencillos son pintar los datos de una tabla xy. Partimos de una tabla (<em>data.frame</em>) que tiene dos campos con las coordenadas <em>lon-lat</em> (x-y).</p>
<p>Pasando la tabla como argumento a la función <em>leaflet</em> y añadiendo una función de trazado de marcas podemos pintarlo en un mapa dinámico. Leaflet detecta los campos con nombres como lat lon, pero en caso de no detectarlos siempre se puede especificar con en la función: <code>addMarkers(lng=df$lon,lat=df$lat...)</code></p>
<p>Para el caso de puntos como una tabla x-y podemos usar las funciones <code>addMarkers</code> o <code>addCircleMarkers</code> indistintamente. Cada una tiene varias opciones de personalización. Veamos un ejemplo:</p>
<pre class="r"><code>    # creamos una data.frame con puntos aleatorios en la zona de Levante (España)
    df = data.frame(
      lat = rnorm(50, mean=39,sd=0.5),
      lng = rnorm(50,mean=0,sd=1),
      size = runif(50, 5, 20),
      color= sample(colors(),50)
    )
    
    # creamos un objeto de mapa leaflet
    m = leaflet(df) %&gt;% addTiles() # añade el mapa por defecto de OpenStreetMap
    # añadimos Una capa de marcas con los datos 
    # la capa tendrá una popup con el texto marcado
    m %&gt;% addMarkers(popup= ~paste(&quot;Hola mundo&quot;, size) )    </code></pre>
<div id="htmlwidget-2" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["Hola mundo 11.223377941642","Hola mundo 19.6328595723026","Hola mundo 5.71982853347436","Hola mundo 10.6063684192486","Hola mundo 10.2139197709039","Hola mundo 5.88530720211565","Hola mundo 12.7723796560895","Hola mundo 8.87009672238491","Hola mundo 17.2385354840662","Hola mundo 5.08370086085051","Hola mundo 18.431931938976","Hola mundo 14.6576230437495","Hola mundo 13.0038190970663","Hola mundo 6.66790442424826","Hola mundo 10.2315872721374","Hola mundo 13.2516196987126","Hola mundo 12.0073909161147","Hola mundo 19.2794757126831","Hola mundo 19.4515955937095","Hola mundo 5.85406580241397","Hola mundo 13.1577588187065","Hola mundo 6.86901625362225","Hola mundo 8.39273026562296","Hola mundo 16.3631292793434","Hola mundo 17.7547640306875","Hola mundo 13.0875566252507","Hola mundo 8.19452905911021","Hola mundo 19.7631755110342","Hola mundo 12.4720203236211","Hola mundo 14.9285961396527","Hola mundo 19.4297500874382","Hola mundo 8.01321066799574","Hola mundo 13.1772913632449","Hola mundo 8.58802084927447","Hola mundo 13.5521590255667","Hola mundo 14.7158980474342","Hola mundo 16.0730439668987","Hola mundo 9.9591490754392","Hola mundo 5.8148604631424","Hola mundo 12.0222547580488","Hola mundo 7.61588331195526","Hola mundo 6.52575292042457","Hola mundo 19.6850629348774","Hola mundo 17.8152578184381","Hola mundo 12.4815084389411","Hola mundo 9.36149287153967","Hola mundo 16.6293689399026","Hola mundo 18.4851197979879","Hola mundo 7.18271016725339","Hola mundo 19.4141908269376"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>    # Cambiamos las marcas por circulos, que tengan un tamaño y color diferente según los valores 
    # creamos una paleta de color continua colorNumeric es funcion de leaflet
    pal &lt;- colorNumeric(palette = &quot;Spectral&quot;, domain = c(df$size), reverse = TRUE)
    
    m %&gt;% addCircleMarkers(radius = ~size, color = ~pal(size), fill = ~pal(size),popup= ~paste0(&quot;mi tamaño es:&quot;,size))</code></pre>
<div id="htmlwidget-3" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],[11.223377941642,19.6328595723026,5.71982853347436,10.6063684192486,10.2139197709039,5.88530720211565,12.7723796560895,8.87009672238491,17.2385354840662,5.08370086085051,18.431931938976,14.6576230437495,13.0038190970663,6.66790442424826,10.2315872721374,13.2516196987126,12.0073909161147,19.2794757126831,19.4515955937095,5.85406580241397,13.1577588187065,6.86901625362225,8.39273026562296,16.3631292793434,17.7547640306875,13.0875566252507,8.19452905911021,19.7631755110342,12.4720203236211,14.9285961396527,19.4297500874382,8.01321066799574,13.1772913632449,8.58802084927447,13.5521590255667,14.7158980474342,16.0730439668987,9.9591490754392,5.8148604631424,12.0222547580488,7.61588331195526,6.52575292042457,19.6850629348774,17.8152578184381,12.4815084389411,9.36149287153967,16.6293689399026,18.4851197979879,7.18271016725339,19.4141908269376],null,null,{"interactive":true,"className":"","stroke":true,"color":["#EBF79F","#A30A43","#5268AE","#D9EF9B","#C9E99E","#4E6FB1","#FFF8B3","#90D2A5","#EB6147","#5E4FA2","#D03A4E","#FEC675","#FFF3AA","#398CBB","#CAE99E","#FFEDA2","#F8FCB4","#B01C46","#A91445","#4F6EB0","#FFEFA5","#4394B8","#7AC9A5","#F8834C","#E1504B","#FFF1A7","#6FC5A5","#9E0142","#FFFEBD","#FEBD6D","#AA1545","#66C2A5","#FFEFA4","#83CCA5","#FFE797","#FEC473","#F99052","#BFE5A0","#506CAF","#F8FCB4","#5DB2AC","#3487BD","#A10643","#DF4E4C","#FFFEBD","#A6DBA4","#F67647","#CE384D","#4FA0B3","#AB1645"],"weight":5,"opacity":0.5,"fill":["#EBF79F","#A30A43","#5268AE","#D9EF9B","#C9E99E","#4E6FB1","#FFF8B3","#90D2A5","#EB6147","#5E4FA2","#D03A4E","#FEC675","#FFF3AA","#398CBB","#CAE99E","#FFEDA2","#F8FCB4","#B01C46","#A91445","#4F6EB0","#FFEFA5","#4394B8","#7AC9A5","#F8834C","#E1504B","#FFF1A7","#6FC5A5","#9E0142","#FFFEBD","#FEBD6D","#AA1545","#66C2A5","#FFEFA4","#83CCA5","#FFE797","#FEC473","#F99052","#BFE5A0","#506CAF","#F8FCB4","#5DB2AC","#3487BD","#A10643","#DF4E4C","#FFFEBD","#A6DBA4","#F67647","#CE384D","#4FA0B3","#AB1645"],"fillColor":["#EBF79F","#A30A43","#5268AE","#D9EF9B","#C9E99E","#4E6FB1","#FFF8B3","#90D2A5","#EB6147","#5E4FA2","#D03A4E","#FEC675","#FFF3AA","#398CBB","#CAE99E","#FFEDA2","#F8FCB4","#B01C46","#A91445","#4F6EB0","#FFEFA5","#4394B8","#7AC9A5","#F8834C","#E1504B","#FFF1A7","#6FC5A5","#9E0142","#FFFEBD","#FEBD6D","#AA1545","#66C2A5","#FFEFA4","#83CCA5","#FFE797","#FEC473","#F99052","#BFE5A0","#506CAF","#F8FCB4","#5DB2AC","#3487BD","#A10643","#DF4E4C","#FFFEBD","#A6DBA4","#F67647","#CE384D","#4FA0B3","#AB1645"],"fillOpacity":0.2},null,null,["mi tamaño es:11.223377941642","mi tamaño es:19.6328595723026","mi tamaño es:5.71982853347436","mi tamaño es:10.6063684192486","mi tamaño es:10.2139197709039","mi tamaño es:5.88530720211565","mi tamaño es:12.7723796560895","mi tamaño es:8.87009672238491","mi tamaño es:17.2385354840662","mi tamaño es:5.08370086085051","mi tamaño es:18.431931938976","mi tamaño es:14.6576230437495","mi tamaño es:13.0038190970663","mi tamaño es:6.66790442424826","mi tamaño es:10.2315872721374","mi tamaño es:13.2516196987126","mi tamaño es:12.0073909161147","mi tamaño es:19.2794757126831","mi tamaño es:19.4515955937095","mi tamaño es:5.85406580241397","mi tamaño es:13.1577588187065","mi tamaño es:6.86901625362225","mi tamaño es:8.39273026562296","mi tamaño es:16.3631292793434","mi tamaño es:17.7547640306875","mi tamaño es:13.0875566252507","mi tamaño es:8.19452905911021","mi tamaño es:19.7631755110342","mi tamaño es:12.4720203236211","mi tamaño es:14.9285961396527","mi tamaño es:19.4297500874382","mi tamaño es:8.01321066799574","mi tamaño es:13.1772913632449","mi tamaño es:8.58802084927447","mi tamaño es:13.5521590255667","mi tamaño es:14.7158980474342","mi tamaño es:16.0730439668987","mi tamaño es:9.9591490754392","mi tamaño es:5.8148604631424","mi tamaño es:12.0222547580488","mi tamaño es:7.61588331195526","mi tamaño es:6.52575292042457","mi tamaño es:19.6850629348774","mi tamaño es:17.8152578184381","mi tamaño es:12.4815084389411","mi tamaño es:9.36149287153967","mi tamaño es:16.6293689399026","mi tamaño es:18.4851197979879","mi tamaño es:7.18271016725339","mi tamaño es:19.4141908269376"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<p>Con los comandos <code>addMarkers</code>, y <code>addCircleMarkers</code> hemos añadido una capa de puntos, pero podemos añadir polígonos, lineas…controles, capas WMS, cada una tiene su función específica delectura de los datos origen:</p>
<ul>
<li><code>addControl</code>: Añade controles HTML al mapa</li>
<li><code>addTiles</code>: Añade la capa base</li>
<li><code>addWMSTiles</code>: Añade capa WMS al mapa</li>
<li><code>addPopups</code>: Añade popups a una capa</li>
<li><code>addMarkers</code>: Añade marcas de posición e iconos al mapa</li>
<li><code>addLabelOnlyMarkers</code>: Añade etiquetas al mapa</li>
<li><code>addCircleMarkers</code>: Añade marcas de circulos al mapa</li>
<li><code>highlightOptions</code>: añade las opciones de subrayado al pasar por encima de una capa (highligh)</li>
<li><code>addCircles</code>: Añade circulos al mapa</li>
<li><code>addPolylines</code>: Añade capa de polilíneas al mapa</li>
<li><code>addRectangles</code>: Añade rectangulos al mapa</li>
<li><code>addPolygons</code>: Añade capa de poligonos al mapa</li>
<li><code>addGeoJSON</code>: Añade datos GeoJSON al mapa</li>
<li><code>addTopoJSON</code>: Añade capas TopoJSON al mapa</li>
</ul>
<p><a href="#indice">Volver al índice</a></p>
<div id="anadir-capas-shp-y-kml" class="section level3">
<h3>Añadir capas shp y kml</h3>
<p>La forma más sencilla de leer y pintar una capa en <em>leaflet</em> es usando la función <code>st_read()</code> del paquete <code>sf</code>. Esta función lee multitud de formatos de SIG y convierte la capa en objeto sf.</p>
<p>Vamos a ver dos ejemplos de capas una de puntos en fomato kml y otra de polígonos en formato shp.</p>
<pre class="r"><code>    library(sf)
 
    # lectura de una capa kml
    capa_kml&lt;-st_read(&#39;../../static/capas/Restaurantes.kml&#39;)</code></pre>
<pre><code>## Reading layer `Restaurantes&#39; from data source `C:\R\publicaciones\enrdados\static\capas\Restaurantes.kml&#39; using driver `KML&#39;
## Simple feature collection with 35 features and 2 fields
## geometry type:  POINT
## dimension:      XYZ
## bbox:           xmin: -3.689788 ymin: 37.56571 xmax: 2.176187 ymax: 41.3794
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="r"><code>    # vemos los nombres de las variables
    names(capa_kml)</code></pre>
<pre><code>## [1] &quot;Name&quot;        &quot;Description&quot; &quot;geometry&quot;</code></pre>
<pre class="r"><code>    #pintar las capas
    leaflet() %&gt;% 
        addTiles() %&gt;% 
        addMarkers(data = capa_kml,
                label = capa_kml$Name,
                labelOptions = 
                    labelOptions(style = list(&quot;font-weight&quot; = &quot;normal&quot;,
                              padding = &quot;3px 8px&quot;),textsize = &quot;12px&quot;))</code></pre>
<div id="htmlwidget-4" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[40.4172802616535,37.9881308171713,37.9812304746737,37.9864366438071,37.9452074586719,37.9387140016178,37.9951346125816,38.0110111232739,37.9847621014412,41.3794018746312,37.9868567049326,38.0069196467813,37.9832590222482,37.9844303709882,37.9843456732221,38.0008781278819,37.9870135416758,38.0079289922708,37.9974839655485,37.9731598067091,37.9775950871869,38.4945084470293,37.9939497303458,37.9833108238779,37.9955886184787,37.9854796207809,37.9774711114233,40.4608882429798,37.9943879527871,37.9842153770964,37.9861700356157,37.5657108437846,37.9867624282222,37.9904934494202,37.9837835846917],[-3.68978826571382,-1.12789728022818,-1.12016736470191,-1.12589886313114,-1.11052573593652,-1.14221331034635,-1.12216484560524,-1.15366367209025,-1.13380219191635,2.17618689478169,-1.12797396725475,-1.14749184487728,-1.12606794471152,-1.13061155049013,-1.13288038252665,-1.13877057500082,-1.1274289824691,-1.15069273576526,-1.13118649977277,-1.12798561010345,-1.13058049912516,-0.270125082255362,-1.12015054559576,-1.13058400201524,-1.1302319498858,-1.14834601907954,-1.13122198749566,-3.68723844308519,-1.14194017062699,-1.12782942267582,-1.12660550461113,-1.26181682912188,-1.13015587606709,-1.13104567234531,-1.13412848954506],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,["Viridiana","Bambino","Quesería Tope","La sidrería escondida","Jazzazza","La Ermita","Da Lucio","La Salica","ZAHER","La Fonda","La Cueva del oso","Del Gallo Blues","La Parranda (nueva)","Casa Carmelina","Gran Bar","Tei","El Candil","Rincón de Lola","La Provençale","La Cancela","La Papa","Restaurante El Emperador","Limon i sal","El Tornasol","SONAMU","Chez Marcel","La Alhambra","Sacha","Tokio","Temporaneo","Alambique","La Taberna de la Tita","Fontana","Casa Portillo","Plaza de abastos de Verónicas"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"12px","textOnly":false,"style":{"font-weight":"normal","padding":"3px 8px"},"className":"","sticky":true},null]}],"limits":{"lat":[37.5657108437846,41.3794018746312],"lng":[-3.68978826571382,2.17618689478169]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>    # lectura de un shp
    capa_shp&lt;-st_read(&#39;../../static/capas/confederaciones.shp&#39;)</code></pre>
<pre><code>## Reading layer `confederaciones&#39; from data source `C:\R\publicaciones\enrdados\static\capas\confederaciones.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 9 features and 1 field
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -12071.73 ymin: 3988549 xmax: 1019462 ymax: 4858225
## epsg (SRID):    NA
## proj4string:    NA</code></pre>
<pre class="r"><code>    names(capa_shp)</code></pre>
<pre><code>## [1] &quot;ID&quot;       &quot;geometry&quot;</code></pre>
<pre class="r"><code>    # como no tiene un sistema de referencia debemos ponerle uno
    # la capa es en UTM en España y probeblemente epgs 25830
    st_crs(capa_shp)&lt;-25830
    # transformamos las coordenadas a geográficas lon-lat 
    capa_shp&lt;-st_transform(capa_shp,crs=4326)

        m&lt;-leaflet() %&gt;% 
        addTiles() %&gt;% 
        addPolygons(data = capa_shp,stroke = TRUE, fillOpacity = 0.8,
                highlight = highlightOptions(weight = 3,
                                              color = &quot;red&quot;,
                                              bringToFront = TRUE))
    m</code></pre>
<div id="htmlwidget-5" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolygons","args":[[[[{"lng":[2.72627531882191,2.66657380785386,2.62795827427684,2.59231760841633,2.50654982153992,2.47885912562247,2.72627531882191],"lat":[42.3861571358664,42.358299843359,42.3332321184937,42.3326355336717,42.3367994673025,42.3661838859404,42.3861571358664]}],[{"lng":[2.47885912562247,1.92408011593796,2.59231760841633,2.60328743105163,1.89913644828314,1.84930182064654,1.75969989762972,1.59846053062443,1.35413055626294,1.1728567490577,1.16964294224407,0.916644556362335,0.971251694227742,0.952255876167493,0.917110671302994,0.89233356923208,0.735331437657507,0.879850016578493,0.68419206648541,0.509727517317277,0.30671893777538,0.193498526167474,0.136640791692307,0.0546309654978948,-0.0719438494114833,0.000476132124307024,-0.0687483245228197,-0.0503554370995515,-0.121131066023879,-0.301708386965956,-0.475937272873304,-0.641781988883529,-0.900682010839335,-1.11835688929486,-1.14373024575401,-1.27971325297303,-1.68203312144937,-1.87073228770684,-1.90736210430377,-2.54333045962341,-2.52215489934982,-2.36562447542655,-2.0510970082503,-1.91042802471103,-2.12385197377737,-2.71275566287493,-3.10699180798668,-3.72274177979623,-4.04312196611667,-4.22767980037505,-4.22943675004064,-3.92857937590741,-3.82759207106745,-3.58785960957449,-3.36809143900109,-3.0683631867268,-2.79070061684422,-2.58839204855679,-2.20627188509746,-2.06922404784568,-1.84808683173998,-1.66775450774391,-1.40922327506397,-1.40960182534739,-1.32770070388653,-1.07093429182896,-0.792531214261568,-0.597051541627711,-0.339494415812584,-0.27069410479893,-0.165266493087633,-0.0459786082902947,0.154042326625271,0.222439433721775,0.291501829049865,0.372471417501017,0.650367742237494,0.655531396822621,0.697021702676276,0.717537342369263,0.91875936515751,0.975294624898185,1.14921948262123,1.34760404290156,1.45300283033907,1.46651459835123,1.46755566291203,1.66606917821906,1.72860344775799,1.88547214912984,1.97490486534068,2.07340681695542,2.13727198209322,2.2567611282768,2.4341394932391,2.47885912562247],"lat":[42.3661838859404,42.3193824167941,42.3326355336717,42.3320982930469,42.2974581623837,42.2535904893,42.1941142118771,42.1029707470263,41.9170432027765,41.7340501144124,41.4466821433273,41.3060881794889,41.2007135467956,41.1381169357615,41.0588168275347,41.0251562984709,40.846345639624,40.7062962210126,40.5658414842536,40.5248975607792,40.6197960469221,40.7380780768652,40.6709306486976,40.6538041301072,40.6609515867688,40.5779147142063,40.5048767779093,40.4593912262819,40.4611771031471,40.4133319720718,40.3732590765049,40.5674750780079,40.672737567102,40.7229300828951,40.5032809246686,40.4467011683277,40.4960041515696,40.7034026818668,40.8211239050314,41.0161174134285,41.2654292018394,41.3673627898235,41.5705710763581,41.8040249962795,41.9672037927447,42.1315375632363,42.2051866417474,42.5696401968905,42.7431685513012,43.0199889556698,43.1079622034322,43.0668032739106,42.9942503772603,42.995732760805,42.9966505187828,42.9678903923977,42.9901569467891,43.0698304907872,42.9953256192378,43.0058872331921,43.0794383569888,43.0921460343377,43.0301826552402,43.0155226254513,43.0876808724121,42.9809836727952,42.9466208629436,42.8400268280735,42.8049984208802,42.8341339518022,42.7690547685727,42.6951433005166,42.7191347052301,42.7246961697786,42.6859338303327,42.712904852067,42.7043748713422,42.7921941180105,42.8201881090219,42.8526557655258,42.795701635043,42.8108517530472,42.73135482285,42.7239826950057,42.5293061748764,42.4408004240105,42.4554229495571,42.4621598865127,42.5035794241165,42.4823219482109,42.3611673759847,42.35684000176,42.4126365507641,42.4218664163608,42.4135711861156,42.3661838859404]}],[{"lng":[3.0121518132186,3.16683478099033,2.72627531882191,2.89394246960358,3.0121518132186],"lat":[42.4579192151817,42.420351019804,42.3861571358664,42.464080864242,42.4579192151817]}],[{"lng":[2.62795827427684,2.62460155094112,2.60328743105163,2.62795827427684],"lat":[42.3332321184937,42.3310514196281,42.3320982930469,42.3332321184937]}]],[[{"lng":[-4.26855086864879,-4.52848575516276,-4.88741858487236,-5.11017420902806,-5.26964361495387,-5.46898422284494,-5.70878381036919,-6.05056009419204,-6.13199431551862,-6.107551769581,-6.35827468289905,-6.34406462532088,-6.306465869067,-6.44208087505118,-6.49230390848063,-6.5447302194359,-6.68198833706771,-6.85930163054179,-7.09544951415136,-7.32467525276835,-7.69951066139909,-7.93422939618576,-8.12622713926459,-8.22984652611035,-8.04468554974852,-8.22464610266801,-8.2294581665516,-8.59312472074638,-8.80173732491633,-8.8590180219606,-8.89745637008113,-8.6176727553534,-8.83251319873633,-8.66618354960121,-8.80397994479494,-8.83315706376133,-8.77047496010569,-8.92583182651535,-8.99641696389117,-9.08240412143987,-8.92415588134065,-9.11792181866673,-9.13237741378229,-9.1793619856798,-9.27417206548292,-9.19112218367827,-9.06340414072648,-8.89096003994169,-8.69118232627825,-8.45262406787417,-8.35390023669537,-8.25384162077694,-8.15251999500079,-8.27639388090773,-8.28914430154638,-7.96346113513772,-7.82239436113394,-7.82004452085676,-7.68356934997212,-7.55918702892563,-7.324718536137,-7.02002011291179,-6.65882244675673,-6.17559410770485,-5.89636652282671,-5.6920315373992,-5.34591820810322,-4.84023461813463,-4.41596752843877,-4.07578194976522,-3.77394689567808,-3.65325728534078,-3.49160567495249,-3.20965616445139,-3.06878959842487,-2.98840111618642,-2.82735840656103,-2.60613402466955,-2.38749317809576,-2.16522405150433,-1.97978752002943,-1.80916909002169,-1.74206054756996,-1.60373563733736,-1.48827684281551,-1.37814748066498,-1.40096640198505,-1.4265818746196,-1.47741427879185,-1.39459227075262,-1.70807390222062,-2.04925550972521,-2.14936328877972,-2.52860808477595,-2.70875823241664,-3.0883126485033,-3.66745507055692,-4.1688439120845,-4.2500449242025,-4.26855086864879],"lat":[43.0635393602235,43.0603622473886,43.0256737570357,43.1097713295338,43.0920532870081,43.0732590805364,43.0678305805258,43.1032156295971,43.1303415876411,43.0430243032192,42.8746299052164,42.6110868095678,42.2748848648968,42.2268949608273,42.0640577718472,41.9451257272061,41.9408004339776,41.949633999869,41.9561048421154,41.8597001275071,41.8889339547089,41.879065773046,41.8266478698555,41.8952740513421,42.0355411055126,42.0714547790053,42.1298825350734,42.0100539104764,41.926363146,41.9087842196234,42.1120528832526,42.2874093775871,42.2619881220095,42.3876408281201,42.3807246101909,42.4818618124152,42.6609727869146,42.6236935230067,42.5320469192283,42.6007979810268,42.8143642148869,42.760158379277,42.9059812868629,42.9767443525164,42.9275872697989,43.0933853440547,43.2175313294135,43.2998761248031,43.3100253104066,43.33634430159,43.355683241169,43.3603366987524,43.3502975390323,43.3886181023569,43.534639677502,43.7398806169159,43.7459341821483,43.7167104040952,43.7810437235975,43.7420987296518,43.5752842529379,43.5424365776998,43.5692469727832,43.5837076661627,43.6497825508751,43.5961277183018,43.5157767489042,43.4517174949843,43.3844376346779,43.4761310671584,43.4932370056985,43.5086546537976,43.4508060220436,43.4076766348815,43.3491890216813,43.3932035054289,43.4517324247625,43.421855229204,43.3017440158099,43.3042022913043,43.3181564929674,43.3822028882993,43.3716207614124,43.2673627332423,43.2895288674007,43.2532399086246,43.1966923133282,43.1330787941936,43.0884296799288,43.0293285802073,43.0779431342151,43.0079592131646,42.9940814237045,43.0402686970448,42.9968718636617,42.9532108890883,42.9659648139843,43.0792666591744,43.1370693011946,43.0635393602235]}]],[[{"lng":[-2.51510342534193,-3.12460967672725,-3.53128786563921,-3.85663093632563,-4.0492067382882,-4.58537278000183,-4.75802647458736,-5.06552339192052,-5.19862190223799,-5.23365470440602,-5.10624622927791,-4.99322535987476,-5.07706004914863,-5.40040251438628,-5.66807938532914,-5.76544759637041,-5.77264284697131,-5.71229763731428,-5.70487924302584,-5.69706385659412,-5.78427947287441,-5.89778881156888,-5.91384138407355,-6.39858596713112,-6.60424337058192,-7.0224085242961,-6.98855460893642,-6.75001335094425,-6.857495030438,-6.86680284452245,-6.85944772169274,-6.8663009851633,-6.73502306848116,-6.43421441756998,-6.26590534490316,-6.21254825028573,-6.33336391649286,-6.58961501804844,-6.59861739621489,-6.46097957422882,-6.32695396082178,-6.30460793941042,-6.35133521778379,-6.36309805408782,-6.35906975016568,-6.20554499709969,-6.11429014407758,-6.12464832634985,-6.05596530249624,-5.83305414810599,-5.55767709097318,-5.13017694519576,-4.88786796853246,-4.46134801225276,-4.28202028502093,-4.23017739218389,-4.22244677558466,-4.1474063461772,-4.04361405471363,-3.08730375150883,-2.49273900651264,-2.06532357634962,-1.93002950233003,-1.97204161739841,-2.40483615791487,-2.51959845722245,-2.51510342534193],"lat":[41.1842069828951,41.1196495917356,41.0304683559194,40.7204192558706,40.7041581571966,40.5513294833147,40.5341597175858,40.5290702618319,40.5313723229629,40.4371078914045,40.3667046898773,40.3146306316332,40.2794591257091,40.2145175070502,40.2086534167672,40.2503764829607,40.426241209722,40.5620439686195,40.7161133256638,40.7932428474944,40.784931007465,40.6578755470361,40.5841266176566,40.2775050615243,40.1832662840043,40.1401392103831,40.2146469593207,40.3986427130311,40.6004387069313,40.7614599891867,40.967036122509,41.0841354020861,41.161803443937,41.3471780763786,41.4840840726143,41.5882551326106,41.6581438576257,41.6944149235771,41.8554547523671,42.2116604729666,42.2889569224578,42.347496637869,42.4964051308604,42.5958644253761,42.8892707189961,42.9570336885546,43.0252490401367,43.125438076841,43.1234305220285,43.0943926446137,43.0661039427977,43.1094005472483,43.0403314487212,43.0660406644846,43.0604612345314,43.1035411669462,42.9799553074851,42.9073025851617,42.772496424338,42.2345388209253,42.0848054593492,41.9374057237857,41.8042092579473,41.628567673921,41.3382325192225,41.2692760129873,41.1842069828951]}]],[[{"lng":[-1.65427014036941,-1.72268467577238,-1.66629884777965,-1.85720489784417,-1.81987158418832,-2.18414320362144,-2.28118789612015,-2.53299807142311,-3.12240179820582,-3.47122490640571,-3.70860191547465,-4.11158712531805,-4.43097844286196,-4.67753092555701,-4.79093205216412,-4.92363372214481,-5.05415625410399,-5.2528406388218,-5.74584620507724,-6.19224517506259,-6.51512309428621,-6.71338276908979,-6.77313116495817,-6.92221459415019,-7.00687102381897,-7.13021454333147,-7.13382795661992,-7.21291537243778,-7.21554496759895,-7.30068368335148,-7.31626971819961,-7.52103457029561,-7.48735143606748,-7.26019688521948,-7.03294772072993,-6.91028347438793,-6.85823031674988,-7.00333693195828,-6.61576103066268,-6.25120906777388,-5.93434269773128,-5.76855652488749,-5.69142522231541,-5.71984292126664,-5.71157975067675,-5.70747990465355,-5.4386468161587,-5.09665813445304,-5.00131116733114,-5.23553244000658,-5.20002738065628,-4.73918475162996,-4.1833529306976,-3.73441808527267,-3.51186247197068,-3.09838979876579,-2.54577951987717,-2.50007536766953,-2.54107869616322,-2.5367956832186,-2.23671617651661,-1.92572397865599,-1.85145752538461,-1.65427014036941],"lat":[40.4853431707177,40.3790868611523,40.3197626780662,40.3658226183621,40.3067594114582,40.2952296388635,40.1784922585389,40.0939811348553,39.9165396894224,39.6183436550548,39.4742194758458,39.6410493763768,39.6143104841398,39.6110113833422,39.594645111642,39.5925232857816,39.5169245555854,39.3615942667674,39.2825625810421,39.0999062902043,39.1885123132722,39.3859745170205,39.4298028801399,39.2902081070683,39.1172443492027,39.1052018673671,39.1669180176854,39.1946730842367,39.2385799875502,39.3967983618517,39.4694949093342,39.6278846051796,39.6537236799727,39.6622943180892,39.6704219521646,39.8506367545541,39.9403888393436,40.1408011742663,40.1892110524237,40.3990942371565,40.6129450676956,40.793069952156,40.7948961466304,40.5448528690102,40.3396718819773,40.2370781270185,40.2137176378023,40.2937765838999,40.3124110491945,40.4378822090393,40.526586533366,40.5491159261339,40.6588472398971,40.8504073336756,41.0410486027636,41.1271959503549,41.1881979953751,41.1416171824115,41.0952354528713,41.0103260094929,40.9198100333719,40.8799798815887,40.7032125051715,40.4853431707177]}]],[[{"lng":[-2.30046633800638,-2.33714231342117,-2.3728524964457,-2.21087703536686,-2.10703558483385,-2.21374775707721,-2.0246624564769,-2.34734328006723,-2.34977615512933,-2.50113759823226,-2.65158559550679,-2.80191148221809,-3.13891324903679,-3.36295302562603,-3.7927160403691,-4.11168528609882,-4.50813685261634,-4.54310159137346,-4.42847494633729,-4.35153262472556,-4.49745125319403,-4.66832928333232,-4.98653468481952,-4.9837244477854,-5.22633336009987,-5.41163671936737,-5.71880435935956,-5.88977360656812,-6.13872641377329,-6.32547458654494,-6.36909923706964,-6.62862109279295,-6.73236987040957,-6.6384484225228,-6.44942513491152,-6.34451532893504,-6.39309223315988,-6.44016507159403,-6.5242885178343,-6.59534384863092,-6.83873659463638,-7.06291546310403,-7.30085764321711,-7.37489679349175,-7.48995503447805,-7.31959779740989,-7.21804954856276,-6.99759004308721,-6.95072654318077,-7.13710281423917,-7.34097708685703,-7.25388024710928,-7.24214242957724,-7.06105517158068,-6.99520702992236,-7.00265649448695,-7.02145608997453,-6.88315807645429,-6.75503635145784,-6.51804971886544,-6.30598357145461,-6.11714735881929,-5.78356831571799,-5.25814517772811,-4.94258994007611,-4.46922240844845,-4.10897677745411,-3.70875083930729,-3.50127706099642,-3.35017781516445,-3.21763563412498,-2.98899929560422,-2.56867190782642,-2.33857158547402,-2.30046633800638],"lat":[40.1639375464943,40.0427592166282,39.9888240880794,39.647554752591,39.5539963202,39.3856727661327,39.3842413573273,39.2544242253829,38.9902796898476,38.8589407618083,38.8007811587697,38.6983967246856,38.6397748703628,38.5365558425991,38.5344348857962,38.619899167565,38.7915672905319,38.6737070033649,38.5577562226543,38.4412596790593,38.2780449639028,38.4225006203371,38.4615632347098,38.3588829680992,38.3692006095825,38.3361844047236,38.0800026528758,38.178635708946,38.3483113474635,38.3578305928905,38.0924893677479,38.0847529594188,37.9347906506111,37.9083935557302,37.8260593185739,37.5503037789977,37.4021858140131,37.224746600187,37.0608668979476,37.0147132603332,37.124453667306,37.2049943561529,37.1965798992797,37.2085326221826,37.6002570623674,37.8413256790733,38.00637107162,38.0434248090312,38.206379445942,38.2146180403036,38.5152674105245,38.6211455084918,38.7389156849763,38.8480375927372,39.0116665230226,39.1434260080901,39.1427778280933,39.3675031658357,39.4450579752945,39.2471031398592,39.1506297175348,39.1411676063762,39.2816662389437,39.3810860560906,39.5922078048774,39.6285065233641,39.6471785669499,39.488893089935,39.6073683469597,39.7399898139414,39.9017264218526,39.9752980163792,40.0918821962674,40.1788343225486,40.1639375464943]}]],[[{"lng":[-2.50134252268302,-2.44551127220513,-2.44630452877438,-2.29654900835957,-1.99705947292156,-1.90392357551359,-1.77196531493072,-1.67781387893547,-1.52496423442891,-1.84354208603708,-1.41073694207513,-1.33628823850415,-1.22655764652778,-1.19055487997377,-1.00533564021295,-0.988680361453672,-1.04791277862328,-0.939730129824466,-0.848363664089343,-0.75308372091561,-0.701387396146235,-0.627994645188451,-0.631315714989018,-0.744435993753743,-0.74712852164368,-0.73579287139504,-0.702042963998154,-0.978962846635947,-1.16403255536443,-1.32990411768384,-1.47556575963877,-1.78908856257438,-1.99217788948045,-2.1768197653961,-2.32387546738099,-2.35970372189668,-2.41409071933134,-2.48800150487043,-2.58083039603975,-2.71079332432469,-2.71061978355431,-2.67287495394608,-2.78445452616791,-2.89612504794438,-2.89602020642093,-2.65328586531553,-2.50286997352391,-2.5020574105689,-2.50134252268302],"lat":[38.8295891791897,38.7706322745175,38.6679004457913,38.667095647735,38.6649109615899,38.6347227344993,38.6921161510122,38.7204410893599,38.8653665789674,38.8983074754342,38.9372427381259,38.9068554414817,38.787841177254,38.7285892159178,38.6522009412285,38.5785411192749,38.4621424929065,38.3282116363027,38.2678691262479,38.3394578372824,38.2063803309725,38.1755696270576,38.0729106626095,38.0164348176887,37.9284319222885,37.6933971429146,37.590009586613,37.5804013426971,37.5540708204863,37.5565343012763,37.6465740720618,37.6648879750006,37.6667982884112,37.6682315336201,37.7425609384475,37.874869466696,38.021936783157,38.0663164979692,38.0666842059189,38.0670758329868,38.1111100078032,38.2431126984661,38.2727262531286,38.3022337354427,38.3756217119779,38.4485420199052,38.6094475689152,38.7268574684494,38.8295891791897]}]],[[{"lng":[-6.57707232890889,-6.36226228646626,-6.48705926839067,-6.7466993917821,-6.63697096314738,-6.38763977466582,-6.32547458654494,-6.13469556452269,-5.71727282692908,-5.43074530616922,-5.23654363603494,-5.04484301301702,-4.98376266462615,-4.68731984988637,-4.4800298707125,-4.42442937352646,-4.38800308671073,-4.38912710614497,-4.44627933229905,-4.48543921456952,-4.54062958746407,-4.50813685261634,-4.37606018965761,-4.16827480730738,-3.90518721026576,-3.60611458099014,-3.28844237489667,-3.12015094557821,-3.04535579250987,-2.87690116672309,-2.78313866028524,-2.51980886557094,-2.52128206728996,-2.57811900384731,-2.69073825393843,-2.85873006573327,-2.76569434300918,-2.7288169323017,-2.71038780644587,-2.72919724622482,-2.56217699528647,-2.43219157868837,-2.43275806486504,-2.37760280076849,-2.32293843944524,-2.32414231622516,-2.10260786414462,-1.84401920054899,-1.45711105273694,-1.33023156827409,-1.4051938869524,-1.48004104949033,-1.6099358491633,-1.73988162980384,-1.79616482862945,-1.83422736170797,-1.8721997124215,-1.91050060670735,-2.00287931516092,-2.07683269151158,-2.16840460276701,-2.22298986585957,-2.25892065768242,-2.60621967354893,-2.62475552381435,-2.715935859242,-2.75240828499991,-3.02595443976577,-3.08066384555257,-3.33597198670374,-3.42715162475347,-3.48185872139709,-3.66446396114098,-3.91983842060944,-4.13849450400421,-4.37553602100632,-4.4650264790213,-4.62645297559348,-4.77223347426201,-5.04302480430736,-5.18625561654351,-5.29209662672781,-5.32615566699462,-5.45284609595035,-5.45010538143442,-5.48395101343697,-5.62890722875693,-5.70164791633132,-5.75634542709569,-5.97641443964355,-6.01651291492966,-6.1455774565097,-6.14734768989656,-6.22712156008161,-6.22895213329767,-6.23139908063784,-6.39893062548939,-6.40022416912569,-6.34814289039773,-6.57707232890889],"lat":[37.0152660993888,37.5351261331222,37.839621913555,37.9390870536659,38.0894495984486,38.0919557331879,38.3578305928905,38.3552658773968,38.0911409018066,38.3504642088833,38.3719867721106,38.3677541140321,38.4693531709904,38.436904593331,38.3369722708199,38.3523374711013,38.3968039853378,38.4554963034428,38.513509368359,38.6010748579489,38.6809929564488,38.7915672905319,38.7491707289685,38.6487001725457,38.5629727277276,38.5649033796837,38.5954711345436,38.6104418569625,38.6545253923953,38.654469416435,38.7130400925604,38.873695201235,38.6535546507584,38.5363583449663,38.4192921956898,38.3755827087997,38.3167233965559,38.2138995747724,38.1698217251049,38.1111542937662,38.0812943833279,38.0807382480091,38.0073500643898,37.9483578308818,37.8453066440674,37.7132046890466,37.6970478310801,37.6947961869978,37.6463341045885,37.5418609576696,37.4841846280821,37.4264575885292,37.3693414338984,37.2974016163967,37.2245903677024,37.1368930757353,37.0491808025596,36.9320968054027,36.8595053625506,36.7866985028838,36.7580118152797,36.7730619632596,36.8320156152799,36.7749477439357,36.7162816559816,36.7165341637394,36.7166156114752,36.7168702687883,36.7168457682446,36.7163989768949,36.7161067107622,36.7158978293639,36.7443812736658,36.7426812897344,36.7261093893218,36.723605682941,36.6344554493513,36.5149183139379,36.5275210719596,36.449791209546,36.3738566086461,36.2691181181576,36.1950642961524,36.1925338059569,36.1045162931121,36.0304240259026,36.0420103718756,36.0550705370042,36.0685025167216,36.1512981433115,36.2530310481761,36.3084079195062,36.3523891718917,36.5263645132608,36.5703406619955,36.6289748980617,36.7123542423734,36.7416656990055,36.8018415514525,37.0152660993888]}]],[[{"lng":[-5.62890722875693,-5.58096594379018,-5.49557665596773,-5.21022603092371,-5.0872407283821,-4.92867951107919,-4.65820129936123,-4.51183652921301,-4.27295233698262,-3.97905215300382,-3.63014747361736,-3.39210216422685,-3.19095797573565,-3.13612809933554,-3.00777152786764,-2.80543829210241,-2.63939155167154,-2.30730229305016,-2.26957664913487,-2.25023672877195,-1.71448312814854,-1.40206263977261,-1.38519900880012,-1.62778887037364,-1.70288742672399,-1.85322477543849,-1.89157835703082,-1.91070946781021,-2.04033167523738,-2.11400983304548,-2.24109328637349,-2.35048124260183,-2.40502165834375,-2.49633754209249,-2.56963811625854,-2.67952456197276,-2.84361965501939,-3.00772090011518,-3.24488442088706,-3.44538738584163,-3.71891503104523,-3.99242039098907,-4.13827787827986,-4.37527432414886,-4.48323744578649,-4.75239594222476,-4.89843435061395,-5.20481261354355,-5.36103318909686,-5.43384027791082,-5.43112366681187,-5.55571396045851,-5.62890722875693],"lat":[36.0420103718756,36.2338733381848,36.3971490552956,36.5789216830175,36.7426083040873,36.9654692483733,37.145705392232,37.1623423309025,37.1357904093302,37.094542271215,37.0088262032245,36.9951705031087,37.0690687892049,37.1425478154505,37.2453890775693,37.3773509759856,37.4797199807868,37.5369573935248,37.6248053128037,37.7127578559856,37.7081333009138,37.6309232415385,37.5573037039681,37.3989077248948,37.3116810976509,37.0930388045232,36.9759626293038,36.9174183198407,36.7864096024683,36.7282570096636,36.7878599644143,36.8031887868106,36.8328365186461,36.833258420901,36.7895024149124,36.7017600915718,36.7020887166223,36.7462360971669,36.7459843852179,36.7160398770499,36.714702178781,36.7127360940133,36.7114306388632,36.7089282622273,36.6342300732657,36.4544133208562,36.4815390528777,36.3881946495589,36.1503434786297,36.1635641027911,36.0755449157018,36.0142362791405,36.0420103718756]}]],[[{"lng":[0.785595772478883,0.773737212899059,0.874657611102083,0.822967957047161,1.03025972742614,1.02903714572676,1.1567998193355,1.21062520334457,1.44007440974581,1.62053517619148,1.80738513066568,1.9890159765693,2.05852850503376,2.13083360344172,2.14137203396015,2.23555560977308,2.29063134582358,2.37419066545001,2.43253584370276,2.47736383152876,2.55453905463491,2.61575757819062,2.66975831568137,2.68160921974824,2.68316312182975,2.77633497832878,2.80161122428371,2.90630337990207,2.96919771737634,3.0155520715001,3.06685393285238,3.11317491460124,3.14405232473282,3.15387712164107,3.17251653012008,3.30291784207771,3.29605625357059,3.15039800653794,3.11184889239797,3.15130652309837,3.21481309079753,3.19389562099867,3.23652124894272,3.19865276365935,3.0931679581445,3.01025469218261,2.91276811472899,2.83485888109995,2.76153741629258,2.36658104683297,2.23864567539362,2.17897591221933,2.11990405239064,1.98098505130221,1.73375800698915,1.51000137933462,1.37752972955443,1.24745674142532,1.16760623074739,1.07736369308002,0.960185574365149,0.785595772478883],"lat":[40.8849574527551,40.9428507041938,41.1120061864738,41.2689911307516,41.4171587751299,41.5206994721435,41.7231338414661,41.8419117239168,42.0459795921991,42.1940675591457,42.3128482407068,42.3568097881763,42.3537562434159,42.3850267048705,42.4190449466929,42.4320160477012,42.4409771582158,42.4198335517248,42.3768366944536,42.3574523614106,42.3537280921754,42.3449883743611,42.3423222481869,42.3877189305444,42.4048861097262,42.4059618516043,42.4276732962941,42.4682919245346,42.4765177955603,42.4740853975789,42.442632248733,42.4401619479946,42.4385047470046,42.3804984371085,42.3335109564555,42.3206415232182,42.2520492204894,42.2657315536323,42.1873318936879,42.1162426011758,42.0553311478651,41.9989901361141,41.9621877789116,41.8895278842061,41.8319701986952,41.7673813704106,41.709231211581,41.6959834759822,41.6479627769912,41.499720181862,41.4373661283196,41.3595925936903,41.2875079957807,41.2648733844408,41.2178362114898,41.1750906702582,41.1284646759547,41.116093519079,41.0557656553122,41.0704994920168,41.0170911810303,40.8849574527551]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.8,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"color":"red","weight":3,"bringToFront":true}]}],"limits":{"lat":[36.0142362791405,43.7810437235975],"lng":[-9.27417206548292,3.30291784207771]}},"evals":[],"jsHooks":[]}</script>
<p>Si nos fijamos hemos cambiado la funcion de lectura, para en un caso pintar marcas con <code>addMarkers</code> y en otro pintar poligonos con <code>addPolygons</code>.</p>
<p>El problema con los objetos sf es que hay un bug en la librería de leaflet y a veces una cada da problemas principalmente con la clase de objetos de polígonos y polilíneas.</p>
<p>Hay dos maneras de solucionar el problema, leer la capa como sp en lugar de sf, eso se puede hacer de varias formas os dejamos un par de ejemlos:</p>
<pre class="r"><code># con la libraría rgdal
    library(rgdal)
    # usando la función readOGR se pueden leer shp, 
    # leemos la capa Rios.shp en la carpeta data
    capa_rios&lt;-readOGR(dsn = &#39;C:/data&#39;,layer = &#39;Rios&#39;,verbose=FALSE)

# con la libraría raster          
    library(raster)
    capa_rios2 &lt;- raster::shapefile(&quot;data/Rios.shp&quot;) 
    
# Otra opcion es convertir en GEOJSON
    capaGeoJSON&lt;-toGeoJSON(system.file(package=&quot;leafletR&quot;, &quot;files&quot;, &quot;data/Rios.kml&quot;))</code></pre>
<p><a href="#indice">Volver al índice</a></p>
</div>
<div id="mapview" class="section level3">
<h3>mapview</h3>
<p>A mi, personalmente me parece una mejor solución usar la librería <code>mapview</code>. Este paquete añade una nueva función a leaflet que permite leer un objeto sf sin problemas <code>addFeatures()</code>. Vamos a ver un ejemplo con una capa de lineas que da problemas con la lectura con la función de <code>addPolylines()</code></p>
<pre class="r"><code># cargamos lalibrería mapview
   library(mapview)
    # lectura de una capa kml
    capa_kml&lt;-st_read(&#39;../../static/capas/canal_postrasvase.kml&#39;)</code></pre>
<pre><code>## Reading layer `canal_postrasvase.kml&#39; from data source `C:\R\publicaciones\enrdados\static\capas\canal_postrasvase.kml&#39; using driver `KML&#39;
## Simple feature collection with 1 feature and 2 fields
## geometry type:  LINESTRING
## dimension:      XYZ
## bbox:           xmin: -1.863226 ymin: 37.41523 xmax: -0.7457735 ymax: 38.16088
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="r"><code>    # vemos los nombres de las variables
    names(capa_kml)</code></pre>
<pre><code>## [1] &quot;Name&quot;        &quot;Description&quot; &quot;geometry&quot;</code></pre>
<pre class="r"><code>    capa_kml$Name&lt;-&quot;red postrasvase&quot;
    leaflet(capa_kml)%&gt;% 
        addProviderTiles(&quot;Esri.WorldTopoMap&quot;) %&gt;%
        addFeatures(capa_kml,color = &quot;red&quot;,weight=12,label = ~capa_kml$Name)</code></pre>
<div id="htmlwidget-6" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolylines","args":[[[[{"lng":[-1.86322599360788,-1.85837456256823,-1.85290444755815,-1.84922343120681,-1.84497751542917,-1.84086929694687,-1.83339311790313,-1.82808188018344,-1.82131561498044,-1.81631043493842,-1.81136373516371,-1.80710996776756,-1.80372577447331,-1.79977464333431,-1.79233609590899,-1.78778877012539,-1.78209451649711,-1.78029210495471,-1.77074817689365,-1.76428157282319,-1.75513973481114,-1.74407585369382,-1.73705601416079,-1.73344697281785,-1.72145350761182,-1.71862199468167,-1.71838623816772,-1.72372337545896,-1.72558304075982,-1.72705871899495,-1.72868868037435,-1.72893002734206,-1.72756068184604,-1.72912561389176,-1.7334672455582,-1.73876628049695,-1.74205529536681,-1.74153398065347,-1.73821768581728,-1.73782785420585,-1.73732116438554,-1.73061440563321,-1.72726497409677,-1.72437748196678,-1.71794234725987,-1.71336157873786,-1.7098577469338,-1.70630727484593,-1.70194202113057,-1.69788146344619,-1.69592542002663,-1.69547882773824,-1.6969310150587,-1.69608152118091,-1.67955006276077,-1.67697639410873,-1.67120921945033,-1.66763983185999,-1.66337319209769,-1.65830676748978,-1.6513943585552,-1.64890829800025,-1.64317300360726,-1.63891774138917,-1.62743022763236,-1.62089288262629,-1.61981664095515,-1.61666657636235,-1.60830823185195,-1.60544662418221,-1.60084000284181,-1.58281549447962,-1.58180016193617,-1.57868693125816,-1.57548453783528,-1.57424018780229,-1.57184168818393,-1.57010459931794,-1.56425665029876,-1.555114878027,-1.55250704976353,-1.54855959777172,-1.5451453194448,-1.54071423649332,-1.53793289943378,-1.53770585419315,-1.53499195346926,-1.5249876788433,-1.51579979177569,-1.50928031207406,-1.50482041223085,-1.49769188104421,-1.49633772131523,-1.49650753747923,-1.49181067504019,-1.48973329408149,-1.48610855369064,-1.48418141466194,-1.48559274139125,-1.4801976325601,-1.47761752309135,-1.47381922033574,-1.47166666125767,-1.46675580972005,-1.46082807626929,-1.44835221210767,-1.4294507590419,-1.42581403258765,-1.42441733381255,-1.41327131033419,-1.40986209721717,-1.40346261589198,-1.39609197861559,-1.38967178819335,-1.38555225393347,-1.38303981150037,-1.38268827503635,-1.38011535897558,-1.37810648803629,-1.37418369948914,-1.3693781254861,-1.36797693520124,-1.36490636056489,-1.35645297477506,-1.35135592716732,-1.35025126668248,-1.34461339132826,-1.34113013574193,-1.3382016594906,-1.33659033465959,-1.3343218509305,-1.3287299447508,-1.32932480807632,-1.32491283363799,-1.32568525966734,-1.32430751399144,-1.32147585399838,-1.32232132152179,-1.31925051941514,-1.32124960710879,-1.33147447785573,-1.33985007033193,-1.34266856597659,-1.3425224069098,-1.3434718995285,-1.34433463988528,-1.34337073907038,-1.34362336910283,-1.34201027625102,-1.33980007160047,-1.34094338016019,-1.34347062387298,-1.34430988348832,-1.34458807177217,-1.34685424517991,-1.34990316917115,-1.35289546929229,-1.35653574055064,-1.36331318816515,-1.36899853778728,-1.37161472557031,-1.37365631990705,-1.37647836147404,-1.37799756475747,-1.38169936961332,-1.37852465009601,-1.37549017632656,-1.37590303238182,-1.37523405672828,-1.36996272935208,-1.36913690103535,-1.36480594567198,-1.35797950647153,-1.35529050058753,-1.3561500837764,-1.3542845452924,-1.35610800429046,-1.3539711505851,-1.35601729401075,-1.3550968033929,-1.35266947554367,-1.35054983497328,-1.35158715100495,-1.35476437630462,-1.35902786784424,-1.36320537630998,-1.36575986755343,-1.36918655862932,-1.37006602502225,-1.36882688535265,-1.35898878291361,-1.35820522093281,-1.356498259705,-1.35859009563308,-1.35753435126725,-1.35666561416404,-1.35572664231799,-1.35445222841663,-1.35428075321807,-1.35380744793922,-1.35105899933381,-1.34568391036116,-1.34301664054546,-1.32091704297319,-1.31332425382941,-1.29396261881919,-1.27493873725772,-1.26906945293586,-1.26455032838734,-1.26184575528922,-1.25954192256696,-1.25482834334717,-1.24977908845245,-1.24670372510408,-1.24293269062988,-1.24108622190946,-1.24216341447359,-1.23825263888636,-1.23352411569744,-1.22966249444102,-1.22581409000963,-1.22270045371922,-1.2173880648499,-1.21083111752591,-1.20742879099407,-1.20539437114699,-1.20542298175191,-1.20588726686879,-1.20539343604309,-1.20189304023437,-1.19738658360135,-1.19282642310994,-1.18962486726159,-1.18397305996818,-1.17948281207802,-1.17656360236363,-1.15682393868024,-1.14702344374458,-1.1413415162039,-1.1378570812577,-1.13462204666235,-1.13320742932069,-1.13045114317973,-1.12701024581621,-1.11997235908104,-1.11704617132512,-1.11350385077411,-1.10528363810496,-1.10083454982066,-1.0961142476927,-1.09104870744474,-1.08551377581377,-1.08257515028766,-1.08088679255267,-1.07929066546831,-1.07619715570097,-1.06767592256508,-1.0649046994413,-1.06114922057348,-1.0578927777684,-1.05602714879033,-1.05026346244879,-1.04760648158064,-1.04236404825329,-1.03524211233169,-1.03143808562438,-1.02744619303377,-1.02332119838807,-1.02029713976608,-1.01603737739563,-1.0105688708673,-1.00574759363184,-1.0015493247896,-0.996947857710952,-0.991457239537707,-0.981787121926774,-0.976195524399846,-0.962608436775281,-0.945918199766839,-0.930082220980057,-0.921124969267639,-0.917528013091143,-0.91266904478994,-0.909269194696143,-0.903483582340736,-0.896903471451355,-0.892710681731491,-0.889053061950347,-0.886491331853866,-0.883028621770729,-0.877655260201751,-0.874928922811813,-0.874404230190437,-0.867771153543613,-0.861648353946936,-0.856296146749201,-0.852907960740572,-0.847293991438988,-0.841159245767229,-0.837758059779531,-0.833315223896305,-0.826770117884212,-0.823486117581774,-0.819833616823882,-0.817165727575422,-0.818975198574109,-0.814430891829867,-0.809379536523634,-0.805045258950943,-0.802682041695368,-0.799091908549861,-0.794847737211758,-0.791440330296769,-0.791794692115,-0.787379443522145,-0.788009585529218,-0.78505985568693,-0.779159682916657,-0.773160345648483,-0.769246983509754,-0.766868478201571,-0.764874821024056,-0.76536612316172,-0.759785260297637,-0.757853908993582,-0.755661823501441,-0.747163923410037,-0.746146524539803,-0.745773472822946,-0.747258182890313,-0.749808265837959,-0.753347834773956,-0.754983363772905,-0.758395011010642,-0.760928968741551,-0.763428089321618,-0.766242382952813,-0.766102092973705,-0.769367533607777,-0.769991232719696,-0.776457280473688,-0.781378971838544,-0.783513632105849,-0.785692321069708,-0.788213210920068,-0.789808260157501,-0.793692129259757,-0.796236123284679,-0.800318800772341,-0.801970372639722,-0.802030495198645,-0.799559778315446,-0.798800433292024,-0.796169544240013,-0.795835521023395,-0.800085857421782,-0.811487049281248,-0.814066566877125,-0.815360011063982,-0.817748609328048,-0.82088974948444,-0.824358307702739,-0.829120788153129,-0.832669977541616,-0.835168897874971,-0.838431245239307,-0.840603182064413,-0.845876412253782,-0.848430204535939,-0.852022358736752,-0.85683174388998,-0.860817104366691,-0.8680230715657,-0.874451617575949,-0.876021344646176,-0.879391240814332,-0.881024757942962,-0.888005337105503,-0.892572482253549,-0.900740171476419,-0.907417627611106,-0.911022901671114,-0.916428786233296,-0.924457966538417,-0.925178081829176,-0.929693132984712,-0.937115467028299,-0.948831116709774,-0.953771618417195,-0.954134826516228,-0.960653611340109,-0.967699437919413,-0.974693025698669,-0.979475849032982,-0.982769306558347,-0.982772316651442,-0.993988411948563,-0.996399149385093,-1.00573383944369,-1.01748891770351,-1.03050378379577,-1.03484619124898,-1.03277441404502,-1.03311357095154,-1.03619288703786,-1.03799242395006,-1.0417805738162,-1.04249480789148,-1.04243069730236,-1.04003829885381,-1.03866545337776,-1.03652648670588,-1.03675854489734,-1.0339295705952,-1.03109643070813,-1.03109643070813],"lat":[37.4152254335681,37.4162719398593,37.4200166203954,37.4233961879183,37.4272674828212,37.4315427503555,37.4341735570763,37.436825373697,37.4396459730017,37.4411495150331,37.4470363152286,37.451193826531,37.4551298326944,37.4583695041291,37.4623336798559,37.4666600896687,37.4659686015368,37.469415745174,37.4788683037281,37.4845701710773,37.4913212981036,37.4956495153559,37.5092112914455,37.5157975157116,37.5402836009165,37.5515689201856,37.5653322033555,37.5719580438584,37.5761462611709,37.5810507550153,37.5840690121519,37.5869588308841,37.5898778034993,37.5990671829748,37.6002090891157,37.602973485101,37.6087128945768,37.6124037176914,37.6180906990379,37.6207789518562,37.6269797897444,37.6324477767835,37.6369750974868,37.641324780441,37.6482826501463,37.6520596302242,37.6546902626443,37.6547739935315,37.6573419935527,37.6601175657268,37.665786434528,37.6707272882884,37.6754146094001,37.6769175696882,37.6803393808172,37.6832943447263,37.6886766683148,37.6926011730509,37.6952096913979,37.6958127853055,37.6967148954606,37.6975856538833,37.7011236607265,37.7030365552958,37.7030693089533,37.7058950531628,37.7076462655056,37.7085048212673,37.7092685311186,37.713649071733,37.7140198609579,37.7225514695486,37.7245011842422,37.7257716308645,37.7290028452495,37.7317357297814,37.7333007511451,37.7373827792636,37.7389057388436,37.7426810226472,37.7470224505639,37.7516702562169,37.7586375361294,37.7633048717127,37.7660249650045,37.7712521936895,37.7761113745115,37.7782718969003,37.7834910809606,37.7908958787069,37.7914186964077,37.7977401805528,37.8069775958417,37.8150445558455,37.8164388013439,37.824170480034,37.8261070753138,37.8306434978831,37.8350245598202,37.8378636423456,37.8451260961067,37.8473244668879,37.854634115685,37.8608254208917,37.8672295373248,37.8702192604711,37.872296162826,37.8739745037303,37.8772594802611,37.8799629115751,37.8798418140436,37.8808978585257,37.8798966465317,37.8736514128203,37.8756973033605,37.8779153049686,37.8809888750419,37.8816292368547,37.8863479312917,37.888020708242,37.8910326122911,37.8943919083,37.8960761835829,37.9090392947316,37.9122716053054,37.9150341636959,37.9169821950348,37.9200865860305,37.9215429240444,37.9246194740092,37.924836332539,37.9308147822555,37.9333590349117,37.9366017601859,37.9401665597201,37.9419171518147,37.9424348149029,37.9444146786393,37.9471471111953,37.9506119712665,37.9535874294934,37.9557324966457,37.9591204518419,37.9623197486186,37.9630086404811,37.9659421164906,37.9675439060984,37.969515268758,37.9715844875883,38.0030141945188,38.005876462938,38.0086681655819,38.0131913354811,38.0178594597107,38.0197163122764,38.0202805705056,38.0191679641347,38.0206714360944,38.0313610852022,38.0389630062492,38.0420839624401,38.0446330482813,38.0463120069639,38.047825571078,38.0512266352848,38.0543670621823,38.0568459627136,38.0607423479096,38.0625242023002,38.0636452677046,38.066393455196,38.0686218908352,38.0713217912266,38.0733074524969,38.0779696405835,38.0806633304586,38.0835493521995,38.0871016110505,38.0893964672014,38.0929989280726,38.096381246227,38.0990840467877,38.1033773099493,38.1040188796443,38.1075113879531,38.1103889728244,38.1107230570531,38.1096097894935,38.11161209582,38.1163379498577,38.1218197113009,38.1361705541902,38.1393557725746,38.1445098677608,38.1465332726666,38.1485592797348,38.1503775268358,38.1521319881903,38.1547144717645,38.1574549255447,38.1598385191939,38.1608804849053,38.1580071742759,38.1452854568852,38.1428940290227,38.1427920085894,38.1424850695966,38.1422510088281,38.141888921492,38.1385849086298,38.1363354117767,38.1347294654617,38.1346543199272,38.133397377686,38.1310654303945,38.1286017981926,38.1242462624235,38.1219722943621,38.1210446586674,38.1214000466759,38.1227418488109,38.1226947707631,38.1208436267303,38.1172598638186,38.1154463781766,38.1125548665763,38.1093856226964,38.1064163075029,38.1045919900902,38.1036107450362,38.1037349482117,38.1040514220045,38.1048525235277,38.1097130628061,38.1103842114872,38.1123813932379,38.1178220348451,38.1211106797525,38.1230500564779,38.1234875758622,38.1247858384319,38.1270555464807,38.1287254816407,38.1295703899021,38.1295916085358,38.1304658822418,38.1339964299247,38.1405115071392,38.1438824598528,38.1457619587817,38.1463796615609,38.1464080164615,38.1444825062522,38.1402424590399,38.1368877645451,38.136235338864,38.1378766938967,38.1357282246028,38.1339081584456,38.1313659382132,38.1293605682062,38.1266837967912,38.1235291439804,38.1209805101798,38.117984313901,38.1167575531194,38.114878363078,38.1128615619615,38.1119450920797,38.1121836918919,38.1128613446736,38.112536148599,38.111977921554,38.1092648895521,38.102024585831,38.0885283819182,38.0806856867908,38.0724259086865,38.0616478552476,38.0517941329241,38.0511573210173,38.0466786747338,38.0423073626275,38.0367065860667,38.0322318425589,38.0325903925435,38.0331487393462,38.0327801056241,38.0353668227947,38.036653840702,38.035404302093,38.0327419676524,38.0319533735621,38.0329629908385,38.0341063110402,38.0331743929926,38.0349428451414,38.0348132231488,38.0327088786616,38.0302777222201,38.0304050570782,38.0260852777378,38.0231713866038,38.0197337550147,38.0167234540868,38.0141338115595,38.0089891536401,38.0032135889456,37.9980041576875,37.9936204384859,37.9897623148644,37.9861538688344,37.9836799142966,37.9809322980624,37.9755388902478,37.972667366827,37.9694702410335,37.9667337768426,37.9636938931166,37.9651135277913,37.9646380275747,37.962233196274,37.9585845176957,37.9579188642291,37.9530488397607,37.9536095155142,37.9469917087495,37.9391277789888,37.9299423515318,37.9276038482226,37.9259742753688,37.9239762300329,37.9220278184838,37.9210027048652,37.9198890073728,37.9181290529954,37.9159046005232,37.9141775420704,37.9140243326436,37.9113679373993,37.9100089953608,37.9053679748278,37.9012337252615,37.8958387469299,37.8933040044894,37.8908378870061,37.8917715047263,37.8902698814949,37.8900019935292,37.8874786154274,37.8854570393345,37.8845070975876,37.8826423413872,37.8816032625087,37.8802937656343,37.8761987917026,37.8745608281495,37.873661970221,37.8703291560614,37.8652362069873,37.8618514950777,37.8586326824299,37.8554928855303,37.8529760970305,37.8510854376486,37.8490796359415,37.8473606067147,37.843777675584,37.8418446943484,37.8396723828412,37.8367044255705,37.834395868389,37.8311266741104,37.8265518815159,37.8248156924963,37.8232272342894,37.8192541912011,37.8151997181876,37.814736494851,37.8084693296,37.808165985708,37.8064935782514,37.8064808319984,37.8011804851529,37.7950071427397,37.7902458998891,37.789019556678,37.7814493546207,37.7808841265034,37.7776346054752,37.7743832920889,37.774342280551,37.7683493125026,37.768367110753,37.7647788505671,37.7614948170258,37.7523699306636,37.7461743286732,37.738748738288,37.7342946203271,37.7215595324821,37.7137637954017,37.7042676720268,37.6994147007553,37.6939458326339,37.6896233590758,37.6870465108409,37.6833782215772,37.6799423445171,37.676958472705,37.6738785909793,37.6700798976411,37.6645417454642,37.6607999306819,37.6588434234395,37.6588434234395]}]]],null,null,{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"overlayPane","stroke":true,"color":"red","weight":12,"opacity":0.5,"fill":false,"fillColor":"red","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"red postrasvase",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[37.4152254335681,38.1608804849053],"lng":[-1.86322599360788,-0.745773472822946]}},"evals":[],"jsHooks":[]}</script>
<p><a href="#indice">Volver al índice</a></p>
</div>
</div>
<div id="opciones-de-personalizacion" class="section level2">
<h2>Opciones de personalización</h2>
<p>Para personalizar un mapa existen multitud de opciones de configuración, vamos a ver solo las más habituales.</p>
<p><a href="#indice">Volver al índice</a></p>
<div id="capa-base" class="section level3">
<h3>Capa base</h3>
<p>Una de las caracteristicas más interesantes es cambiar el mapa de fondo por defecto a cualquiera de los mapas libres disponibles. Esto se hace con el comando sutituyendo <code>addTiles()</code>por <code>addProviderTiles()</code>.</p>
<pre class="r"><code># Cambiamos fondo a tipo toner
    leaflet(df) %&gt;% addProviderTiles(providers$Stamen.Toner) %&gt;%
        addCircleMarkers(radius = 7, color = &quot;red&quot;,
                         popup= paste(&quot;adios&quot;,df$size) )</code></pre>
<div id="htmlwidget-7" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-7">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.Toner",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],7,null,null,{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2},null,null,["adios 11.223377941642","adios 19.6328595723026","adios 5.71982853347436","adios 10.6063684192486","adios 10.2139197709039","adios 5.88530720211565","adios 12.7723796560895","adios 8.87009672238491","adios 17.2385354840662","adios 5.08370086085051","adios 18.431931938976","adios 14.6576230437495","adios 13.0038190970663","adios 6.66790442424826","adios 10.2315872721374","adios 13.2516196987126","adios 12.0073909161147","adios 19.2794757126831","adios 19.4515955937095","adios 5.85406580241397","adios 13.1577588187065","adios 6.86901625362225","adios 8.39273026562296","adios 16.3631292793434","adios 17.7547640306875","adios 13.0875566252507","adios 8.19452905911021","adios 19.7631755110342","adios 12.4720203236211","adios 14.9285961396527","adios 19.4297500874382","adios 8.01321066799574","adios 13.1772913632449","adios 8.58802084927447","adios 13.5521590255667","adios 14.7158980474342","adios 16.0730439668987","adios 9.9591490754392","adios 5.8148604631424","adios 12.0222547580488","adios 7.61588331195526","adios 6.52575292042457","adios 19.6850629348774","adios 17.8152578184381","adios 12.4815084389411","adios 9.36149287153967","adios 16.6293689399026","adios 18.4851197979879","adios 7.18271016725339","adios 19.4141908269376"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<p>En estos momentos existen 137 mapas de fondo disponibles, ¿ cómo saberlo?, pues ejecutando el comando <code>names(providers)</code>, que enumera todos los proveedores de capas base.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
a
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OpenStreetMap
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenStreetMap.Mapnik
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenStreetMap.BlackAndWhite
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenStreetMap.DE
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenStreetMap.CH
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenStreetMap.France
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenStreetMap.HOT
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenStreetMap.BZH
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenInfraMap
</td>
</tr>
<tr>
<td style="text-align:left;">
OpenInfraMap.Power
</td>
</tr>
</tbody>
</table>
<p><a href="#indice">Volver al índice</a></p>
</div>
<div id="anadir-grupos" class="section level3">
<h3>Añadir Grupos</h3>
<p>Para dejar a la elección del usuario el mapa de fondo, podemos hacer grupos y mostrar un selector de capa base en el plano, también podemos hacer grupos en las capas que vams añadiendo al mapa como marcas, poligonos, lineas. Los grupos se forman con la función <code>addLayersControl</code>, en la que está el parámetro <code>baseGroups</code> para las capas de fondos y <code>overlayGroups</code> para el resto de capas:</p>
<pre class="r"><code>    leaflet(df) %&gt;% 
        addProviderTiles(&quot;Stamen.TonerLite&quot;,group = &quot;Toner&quot;) %&gt;%
        addProviderTiles(&quot;HikeBike&quot;, group = &quot;Bike&quot;) %&gt;% 
        addProviderTiles(&quot;Esri&quot;, group = &quot;Esri&quot;) %&gt;%
    addProviderTiles(&quot;Stamen.Watercolor&quot;, group=&quot;Acuarela&quot;) %&gt;%
    addCircleMarkers(radius = 4, color = &quot;red&quot;,group=&quot;capapuntos&quot;, popup= ~paste0(&quot;mi tamaño es:&quot;,size)) %&gt;%
    addLayersControl(overlayGroups = c(&quot;capapuntos&quot;),baseGroups = c(&quot;Toner&quot;, &quot;Bike&quot;, &quot;Esri&quot;,&quot;Acuarela&quot;)) </code></pre>
<div id="htmlwidget-8" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-8">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,"Toner",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["HikeBike",null,"Bike",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Esri",null,"Esri",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Stamen.Watercolor",null,"Acuarela",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],4,null,"capapuntos",{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.2},null,null,["mi tamaño es:11.223377941642","mi tamaño es:19.6328595723026","mi tamaño es:5.71982853347436","mi tamaño es:10.6063684192486","mi tamaño es:10.2139197709039","mi tamaño es:5.88530720211565","mi tamaño es:12.7723796560895","mi tamaño es:8.87009672238491","mi tamaño es:17.2385354840662","mi tamaño es:5.08370086085051","mi tamaño es:18.431931938976","mi tamaño es:14.6576230437495","mi tamaño es:13.0038190970663","mi tamaño es:6.66790442424826","mi tamaño es:10.2315872721374","mi tamaño es:13.2516196987126","mi tamaño es:12.0073909161147","mi tamaño es:19.2794757126831","mi tamaño es:19.4515955937095","mi tamaño es:5.85406580241397","mi tamaño es:13.1577588187065","mi tamaño es:6.86901625362225","mi tamaño es:8.39273026562296","mi tamaño es:16.3631292793434","mi tamaño es:17.7547640306875","mi tamaño es:13.0875566252507","mi tamaño es:8.19452905911021","mi tamaño es:19.7631755110342","mi tamaño es:12.4720203236211","mi tamaño es:14.9285961396527","mi tamaño es:19.4297500874382","mi tamaño es:8.01321066799574","mi tamaño es:13.1772913632449","mi tamaño es:8.58802084927447","mi tamaño es:13.5521590255667","mi tamaño es:14.7158980474342","mi tamaño es:16.0730439668987","mi tamaño es:9.9591490754392","mi tamaño es:5.8148604631424","mi tamaño es:12.0222547580488","mi tamaño es:7.61588331195526","mi tamaño es:6.52575292042457","mi tamaño es:19.6850629348774","mi tamaño es:17.8152578184381","mi tamaño es:12.4815084389411","mi tamaño es:9.36149287153967","mi tamaño es:16.6293689399026","mi tamaño es:18.4851197979879","mi tamaño es:7.18271016725339","mi tamaño es:19.4141908269376"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Toner","Bike","Esri","Acuarela"],"capapuntos",{"collapsed":true,"autoZIndex":true,"position":"topright"}]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<p><a href="#indice">Volver al índice</a></p>
</div>
<div id="opciones" class="section level3">
<h3>Otras opciones generales: zoom, busqueda, medida, escala</h3>
<p>Los mapas con Leaflet son personalizables en muchos aspectos, podemos añadir un escala gráfica, el norte, leyendas, fijar el zoom máximo y mínimo, fijar una caja de visualización del mapa (<em>fitBounds</em>), fijar el punto central de inicio del mapa (<em>setView</em>) …</p>
<pre class="r"><code>    # fijar un punto central y un zoom 
    leaflet() %&gt;% 
     addTiles() %&gt;% 
     setView(lng = -73.98575, 
             lat = 40.74856, 
             zoom = 13)
    # fijar una caja de inicio, fitbounds
        leaflet() %&gt;% 
            addTiles() %&gt;% 
             fitBounds(
              lng1 = -73.910, lat1 = 40.773, 
              lng2 = -74.060, lat2 = 40.723)
    # limitar zooms y permitir o no el dragging con la mano
    leaflet(options = 
         leafletOptions(dragging = FALSE,
                        minZoom = 14, 
                        maxZoom = 18))  %&gt;% 
         addProviderTiles(&quot;CartoDB&quot;)  %&gt;% 
         setView(lng = -73.98575, lat = 40.74856, zoom = 18) 

# Establecer max caja en un mapa 
    leaflet() %&gt;%
      setMaxBounds(lng1 = dc_hq$lon[2] + .05, 
                   lat1 = dc_hq$lat[2] + .05, 
                   lng2 = dc_hq$lon[2] - .05, 
                   lat2 = dc_hq$lat[2] - .05)

# opcion de limpiar el mapa 
        m %&gt;% clearBounds() %&gt;% clearMarkers()</code></pre>
<p>Ejemplo completo con algunas personalizaciones:</p>
<pre class="r"><code>     # establer valores generales de zoom minimo y maximo
    leaflet(df) %&gt;% 
        setView(lng = -0.15, lat = 40.14, zoom = 8)%&gt;%
        addProviderTiles(&quot;Stamen.TonerLite&quot;,group = &quot;Toner&quot;) %&gt;%
        addProviderTiles(&quot;HikeBike&quot;, group = &quot;Bike&quot;) %&gt;% 
        addProviderTiles(&quot;Esri&quot;, group = &quot;Esri&quot;) %&gt;%
        addProviderTiles(&quot;Stamen.Watercolor&quot;, group=&quot;Acuarela&quot;) %&gt;%
    addLayersControl(baseGroups = c(&quot;OSM&quot;, &quot;Bike&quot;, &quot;Esri&quot;,&quot;Acuarela&quot;)) %&gt;%                addCircleMarkers(radius = 5, color = ~pal(size),                                                       opacity = 0.8,
                     popup= ~paste0(&quot;mi tamaño es: &quot;,signif(size,2)))%&gt;%
    addLegend(pal = pal,
                   values = df$size,
                   opacity = 0.75,
                   title = &quot;Tamaño&quot;,
                   position = &quot;topleft&quot;)%&gt;%    
    # añade el pluggin con opciones de medicion
    addMeasure(position = &quot;bottomleft&quot;,
        primaryLengthUnit = &quot;meters&quot;,
        primaryAreaUnit = &quot;sqmeters&quot;,
        activeColor = &quot;#3D535D&quot;,
        completedColor = &quot;#7D4479&quot;)</code></pre>
<div id="htmlwidget-9" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-9">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[40.14,-0.15],8,[]],"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,"Toner",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["HikeBike",null,"Bike",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Esri",null,"Esri",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Stamen.Watercolor",null,"Acuarela",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addLayersControl","args":[["OSM","Bike","Esri","Acuarela"],[],{"collapsed":true,"autoZIndex":true,"position":"topright"}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],5,null,null,{"interactive":true,"className":"","stroke":true,"color":["#EBF79F","#A30A43","#5268AE","#D9EF9B","#C9E99E","#4E6FB1","#FFF8B3","#90D2A5","#EB6147","#5E4FA2","#D03A4E","#FEC675","#FFF3AA","#398CBB","#CAE99E","#FFEDA2","#F8FCB4","#B01C46","#A91445","#4F6EB0","#FFEFA5","#4394B8","#7AC9A5","#F8834C","#E1504B","#FFF1A7","#6FC5A5","#9E0142","#FFFEBD","#FEBD6D","#AA1545","#66C2A5","#FFEFA4","#83CCA5","#FFE797","#FEC473","#F99052","#BFE5A0","#506CAF","#F8FCB4","#5DB2AC","#3487BD","#A10643","#DF4E4C","#FFFEBD","#A6DBA4","#F67647","#CE384D","#4FA0B3","#AB1645"],"weight":5,"opacity":0.8,"fill":true,"fillColor":["#EBF79F","#A30A43","#5268AE","#D9EF9B","#C9E99E","#4E6FB1","#FFF8B3","#90D2A5","#EB6147","#5E4FA2","#D03A4E","#FEC675","#FFF3AA","#398CBB","#CAE99E","#FFEDA2","#F8FCB4","#B01C46","#A91445","#4F6EB0","#FFEFA5","#4394B8","#7AC9A5","#F8834C","#E1504B","#FFF1A7","#6FC5A5","#9E0142","#FFFEBD","#FEBD6D","#AA1545","#66C2A5","#FFEFA4","#83CCA5","#FFE797","#FEC473","#F99052","#BFE5A0","#506CAF","#F8FCB4","#5DB2AC","#3487BD","#A10643","#DF4E4C","#FFFEBD","#A6DBA4","#F67647","#CE384D","#4FA0B3","#AB1645"],"fillOpacity":0.2},null,null,["mi tamaño es: 11","mi tamaño es: 20","mi tamaño es: 5.7","mi tamaño es: 11","mi tamaño es: 10","mi tamaño es: 5.9","mi tamaño es: 13","mi tamaño es: 8.9","mi tamaño es: 17","mi tamaño es: 5.1","mi tamaño es: 18","mi tamaño es: 15","mi tamaño es: 13","mi tamaño es: 6.7","mi tamaño es: 10","mi tamaño es: 13","mi tamaño es: 12","mi tamaño es: 19","mi tamaño es: 19","mi tamaño es: 5.9","mi tamaño es: 13","mi tamaño es: 6.9","mi tamaño es: 8.4","mi tamaño es: 16","mi tamaño es: 18","mi tamaño es: 13","mi tamaño es: 8.2","mi tamaño es: 20","mi tamaño es: 12","mi tamaño es: 15","mi tamaño es: 19","mi tamaño es: 8","mi tamaño es: 13","mi tamaño es: 8.6","mi tamaño es: 14","mi tamaño es: 15","mi tamaño es: 16","mi tamaño es: 10","mi tamaño es: 5.8","mi tamaño es: 12","mi tamaño es: 7.6","mi tamaño es: 6.5","mi tamaño es: 20","mi tamaño es: 18","mi tamaño es: 12","mi tamaño es: 9.4","mi tamaño es: 17","mi tamaño es: 18","mi tamaño es: 7.2","mi tamaño es: 19"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#5E4FA2 , #4B73B3 6.24204313155049%, #66C1A5 19.8665089088389%, #C0E5A0 33.4909746861273%, #F8FCB4 47.1154404634156%, #FEDC88 60.739906240704%, #FA9354 74.3643720179924%, #DB484D 87.9888377952808%, #9E0142 "],"labels":["6","8","10","12","14","16","18"],"na_color":null,"na_label":"NA","opacity":0.75,"position":"topleft","type":"numeric","title":"Tamaño","extra":{"p_1":0.0624204313155049,"p_n":0.879888377952808},"layerId":null,"className":"info legend","group":null}]},{"method":"addMeasure","args":[{"position":"bottomleft","primaryLengthUnit":"meters","primaryAreaUnit":"sqmeters","activeColor":"#3D535D","completedColor":"#7D4479","popupOptions":{"className":"leaflet-measure-resultpopup","autoPanPadding":[10,10]},"captureZIndex":10000,"localization":"en","decPoint":".","thousandsSep":","}]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<p><a href="#indice">Volver al índice</a></p>
</div>
</div>
<div id="popups" class="section level2">
<h2>Popups con html</h2>
<p>Otra funcionalidad importante es que podemos usar html en la popups y hacerlas muy atractivas. Por ejemplo usando el tag <code>&lt;br/&gt;</code> para crear una linea de corte. o usar la función <code>sprintf</code> para generar una lista completa de las eqtiquetas formateadas a partir de los valores de la tabla o capa de origen.</p>
<pre class="r"><code># Añadimos directamente código html
m&lt;-leaflet(df) %&gt;% addTiles() %&gt;%
    addCircleMarkers(data = df, radius = 2, color = ~color,
                     popup = ~paste0(&quot;el color es:&quot;, &quot;&lt;br/&gt;&quot;, color))
m</code></pre>
<div id="htmlwidget-10" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-10">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],2,null,null,{"interactive":true,"className":"","stroke":true,"color":["darkolivegreen2","deeppink4","grey7","ivory2","palegreen4","grey46","gold","deeppink2","cyan","grey38","lightslategray","red2","grey90","cornsilk4","gray27","olivedrab2","gray80","deepskyblue2","deepskyblue","mediumorchid3","grey22","gray0","gray3","grey41","lemonchiffon","gray53","plum2","grey87","oldlace","seagreen2","tomato2","firebrick2","azure1","gray77","firebrick4","peru","skyblue2","gray62","gray74","slateblue4","honeydew1","gray34","dimgrey","peachpuff2","thistle1","darkorange2","yellow1","grey66","darkslategray2","lightskyblue3"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["darkolivegreen2","deeppink4","grey7","ivory2","palegreen4","grey46","gold","deeppink2","cyan","grey38","lightslategray","red2","grey90","cornsilk4","gray27","olivedrab2","gray80","deepskyblue2","deepskyblue","mediumorchid3","grey22","gray0","gray3","grey41","lemonchiffon","gray53","plum2","grey87","oldlace","seagreen2","tomato2","firebrick2","azure1","gray77","firebrick4","peru","skyblue2","gray62","gray74","slateblue4","honeydew1","gray34","dimgrey","peachpuff2","thistle1","darkorange2","yellow1","grey66","darkslategray2","lightskyblue3"],"fillOpacity":0.2},null,null,["el color es:<br/>darkolivegreen2","el color es:<br/>deeppink4","el color es:<br/>grey7","el color es:<br/>ivory2","el color es:<br/>palegreen4","el color es:<br/>grey46","el color es:<br/>gold","el color es:<br/>deeppink2","el color es:<br/>cyan","el color es:<br/>grey38","el color es:<br/>lightslategray","el color es:<br/>red2","el color es:<br/>grey90","el color es:<br/>cornsilk4","el color es:<br/>gray27","el color es:<br/>olivedrab2","el color es:<br/>gray80","el color es:<br/>deepskyblue2","el color es:<br/>deepskyblue","el color es:<br/>mediumorchid3","el color es:<br/>grey22","el color es:<br/>gray0","el color es:<br/>gray3","el color es:<br/>grey41","el color es:<br/>lemonchiffon","el color es:<br/>gray53","el color es:<br/>plum2","el color es:<br/>grey87","el color es:<br/>oldlace","el color es:<br/>seagreen2","el color es:<br/>tomato2","el color es:<br/>firebrick2","el color es:<br/>azure1","el color es:<br/>gray77","el color es:<br/>firebrick4","el color es:<br/>peru","el color es:<br/>skyblue2","el color es:<br/>gray62","el color es:<br/>gray74","el color es:<br/>slateblue4","el color es:<br/>honeydew1","el color es:<br/>gray34","el color es:<br/>dimgrey","el color es:<br/>peachpuff2","el color es:<br/>thistle1","el color es:<br/>darkorange2","el color es:<br/>yellow1","el color es:<br/>grey66","el color es:<br/>darkslategray2","el color es:<br/>lightskyblue3"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># creamos una etiqueta compleja en html con sprintf
labels &lt;- sprintf(
  &quot;Color:&lt;strong&gt;%s&lt;/strong&gt;&lt;br/&gt; tamaño: %g m&lt;sup&gt;2&lt;/sup&gt;&quot;,
  df$color, df$size
) %&gt;% lapply(htmltools::HTML)

    m %&gt;% addCircleMarkers(data = df, radius = 2, color = ~color,
                     label = labels)</code></pre>
<div id="htmlwidget-11" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-11">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],2,null,null,{"interactive":true,"className":"","stroke":true,"color":["darkolivegreen2","deeppink4","grey7","ivory2","palegreen4","grey46","gold","deeppink2","cyan","grey38","lightslategray","red2","grey90","cornsilk4","gray27","olivedrab2","gray80","deepskyblue2","deepskyblue","mediumorchid3","grey22","gray0","gray3","grey41","lemonchiffon","gray53","plum2","grey87","oldlace","seagreen2","tomato2","firebrick2","azure1","gray77","firebrick4","peru","skyblue2","gray62","gray74","slateblue4","honeydew1","gray34","dimgrey","peachpuff2","thistle1","darkorange2","yellow1","grey66","darkslategray2","lightskyblue3"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["darkolivegreen2","deeppink4","grey7","ivory2","palegreen4","grey46","gold","deeppink2","cyan","grey38","lightslategray","red2","grey90","cornsilk4","gray27","olivedrab2","gray80","deepskyblue2","deepskyblue","mediumorchid3","grey22","gray0","gray3","grey41","lemonchiffon","gray53","plum2","grey87","oldlace","seagreen2","tomato2","firebrick2","azure1","gray77","firebrick4","peru","skyblue2","gray62","gray74","slateblue4","honeydew1","gray34","dimgrey","peachpuff2","thistle1","darkorange2","yellow1","grey66","darkslategray2","lightskyblue3"],"fillOpacity":0.2},null,null,["el color es:<br/>darkolivegreen2","el color es:<br/>deeppink4","el color es:<br/>grey7","el color es:<br/>ivory2","el color es:<br/>palegreen4","el color es:<br/>grey46","el color es:<br/>gold","el color es:<br/>deeppink2","el color es:<br/>cyan","el color es:<br/>grey38","el color es:<br/>lightslategray","el color es:<br/>red2","el color es:<br/>grey90","el color es:<br/>cornsilk4","el color es:<br/>gray27","el color es:<br/>olivedrab2","el color es:<br/>gray80","el color es:<br/>deepskyblue2","el color es:<br/>deepskyblue","el color es:<br/>mediumorchid3","el color es:<br/>grey22","el color es:<br/>gray0","el color es:<br/>gray3","el color es:<br/>grey41","el color es:<br/>lemonchiffon","el color es:<br/>gray53","el color es:<br/>plum2","el color es:<br/>grey87","el color es:<br/>oldlace","el color es:<br/>seagreen2","el color es:<br/>tomato2","el color es:<br/>firebrick2","el color es:<br/>azure1","el color es:<br/>gray77","el color es:<br/>firebrick4","el color es:<br/>peru","el color es:<br/>skyblue2","el color es:<br/>gray62","el color es:<br/>gray74","el color es:<br/>slateblue4","el color es:<br/>honeydew1","el color es:<br/>gray34","el color es:<br/>dimgrey","el color es:<br/>peachpuff2","el color es:<br/>thistle1","el color es:<br/>darkorange2","el color es:<br/>yellow1","el color es:<br/>grey66","el color es:<br/>darkslategray2","el color es:<br/>lightskyblue3"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],2,null,null,{"interactive":true,"className":"","stroke":true,"color":["darkolivegreen2","deeppink4","grey7","ivory2","palegreen4","grey46","gold","deeppink2","cyan","grey38","lightslategray","red2","grey90","cornsilk4","gray27","olivedrab2","gray80","deepskyblue2","deepskyblue","mediumorchid3","grey22","gray0","gray3","grey41","lemonchiffon","gray53","plum2","grey87","oldlace","seagreen2","tomato2","firebrick2","azure1","gray77","firebrick4","peru","skyblue2","gray62","gray74","slateblue4","honeydew1","gray34","dimgrey","peachpuff2","thistle1","darkorange2","yellow1","grey66","darkslategray2","lightskyblue3"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["darkolivegreen2","deeppink4","grey7","ivory2","palegreen4","grey46","gold","deeppink2","cyan","grey38","lightslategray","red2","grey90","cornsilk4","gray27","olivedrab2","gray80","deepskyblue2","deepskyblue","mediumorchid3","grey22","gray0","gray3","grey41","lemonchiffon","gray53","plum2","grey87","oldlace","seagreen2","tomato2","firebrick2","azure1","gray77","firebrick4","peru","skyblue2","gray62","gray74","slateblue4","honeydew1","gray34","dimgrey","peachpuff2","thistle1","darkorange2","yellow1","grey66","darkslategray2","lightskyblue3"],"fillOpacity":0.2},null,null,null,null,["Color:<strong>darkolivegreen2<\/strong><br/> tamaño: 11.2234 m<sup>2<\/sup>","Color:<strong>deeppink4<\/strong><br/> tamaño: 19.6329 m<sup>2<\/sup>","Color:<strong>grey7<\/strong><br/> tamaño: 5.71983 m<sup>2<\/sup>","Color:<strong>ivory2<\/strong><br/> tamaño: 10.6064 m<sup>2<\/sup>","Color:<strong>palegreen4<\/strong><br/> tamaño: 10.2139 m<sup>2<\/sup>","Color:<strong>grey46<\/strong><br/> tamaño: 5.88531 m<sup>2<\/sup>","Color:<strong>gold<\/strong><br/> tamaño: 12.7724 m<sup>2<\/sup>","Color:<strong>deeppink2<\/strong><br/> tamaño: 8.8701 m<sup>2<\/sup>","Color:<strong>cyan<\/strong><br/> tamaño: 17.2385 m<sup>2<\/sup>","Color:<strong>grey38<\/strong><br/> tamaño: 5.0837 m<sup>2<\/sup>","Color:<strong>lightslategray<\/strong><br/> tamaño: 18.4319 m<sup>2<\/sup>","Color:<strong>red2<\/strong><br/> tamaño: 14.6576 m<sup>2<\/sup>","Color:<strong>grey90<\/strong><br/> tamaño: 13.0038 m<sup>2<\/sup>","Color:<strong>cornsilk4<\/strong><br/> tamaño: 6.6679 m<sup>2<\/sup>","Color:<strong>gray27<\/strong><br/> tamaño: 10.2316 m<sup>2<\/sup>","Color:<strong>olivedrab2<\/strong><br/> tamaño: 13.2516 m<sup>2<\/sup>","Color:<strong>gray80<\/strong><br/> tamaño: 12.0074 m<sup>2<\/sup>","Color:<strong>deepskyblue2<\/strong><br/> tamaño: 19.2795 m<sup>2<\/sup>","Color:<strong>deepskyblue<\/strong><br/> tamaño: 19.4516 m<sup>2<\/sup>","Color:<strong>mediumorchid3<\/strong><br/> tamaño: 5.85407 m<sup>2<\/sup>","Color:<strong>grey22<\/strong><br/> tamaño: 13.1578 m<sup>2<\/sup>","Color:<strong>gray0<\/strong><br/> tamaño: 6.86902 m<sup>2<\/sup>","Color:<strong>gray3<\/strong><br/> tamaño: 8.39273 m<sup>2<\/sup>","Color:<strong>grey41<\/strong><br/> tamaño: 16.3631 m<sup>2<\/sup>","Color:<strong>lemonchiffon<\/strong><br/> tamaño: 17.7548 m<sup>2<\/sup>","Color:<strong>gray53<\/strong><br/> tamaño: 13.0876 m<sup>2<\/sup>","Color:<strong>plum2<\/strong><br/> tamaño: 8.19453 m<sup>2<\/sup>","Color:<strong>grey87<\/strong><br/> tamaño: 19.7632 m<sup>2<\/sup>","Color:<strong>oldlace<\/strong><br/> tamaño: 12.472 m<sup>2<\/sup>","Color:<strong>seagreen2<\/strong><br/> tamaño: 14.9286 m<sup>2<\/sup>","Color:<strong>tomato2<\/strong><br/> tamaño: 19.4298 m<sup>2<\/sup>","Color:<strong>firebrick2<\/strong><br/> tamaño: 8.01321 m<sup>2<\/sup>","Color:<strong>azure1<\/strong><br/> tamaño: 13.1773 m<sup>2<\/sup>","Color:<strong>gray77<\/strong><br/> tamaño: 8.58802 m<sup>2<\/sup>","Color:<strong>firebrick4<\/strong><br/> tamaño: 13.5522 m<sup>2<\/sup>","Color:<strong>peru<\/strong><br/> tamaño: 14.7159 m<sup>2<\/sup>","Color:<strong>skyblue2<\/strong><br/> tamaño: 16.073 m<sup>2<\/sup>","Color:<strong>gray62<\/strong><br/> tamaño: 9.95915 m<sup>2<\/sup>","Color:<strong>gray74<\/strong><br/> tamaño: 5.81486 m<sup>2<\/sup>","Color:<strong>slateblue4<\/strong><br/> tamaño: 12.0223 m<sup>2<\/sup>","Color:<strong>honeydew1<\/strong><br/> tamaño: 7.61588 m<sup>2<\/sup>","Color:<strong>gray34<\/strong><br/> tamaño: 6.52575 m<sup>2<\/sup>","Color:<strong>dimgrey<\/strong><br/> tamaño: 19.6851 m<sup>2<\/sup>","Color:<strong>peachpuff2<\/strong><br/> tamaño: 17.8153 m<sup>2<\/sup>","Color:<strong>thistle1<\/strong><br/> tamaño: 12.4815 m<sup>2<\/sup>","Color:<strong>darkorange2<\/strong><br/> tamaño: 9.36149 m<sup>2<\/sup>","Color:<strong>yellow1<\/strong><br/> tamaño: 16.6294 m<sup>2<\/sup>","Color:<strong>grey66<\/strong><br/> tamaño: 18.4851 m<sup>2<\/sup>","Color:<strong>darkslategray2<\/strong><br/> tamaño: 7.18271 m<sup>2<\/sup>","Color:<strong>lightskyblue3<\/strong><br/> tamaño: 19.4142 m<sup>2<\/sup>"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<p><a href="#indice">Volver al índice</a></p>
</div>
<div id="colores" class="section level2">
<h2>Colores</h2>
<p>Leaflet tiene funciones específicas para colorear escalas en los mapas. Hay tres funciones básicas:</p>
<ul>
<li><code>colorFactor</code> para colorear variables discretas</li>
<li><code>colorNumeric</code>para escalas continuas numéricas</li>
<li><code>colorQuantile</code> para mejorar la coloracion en conjuntos con sesgo</li>
</ul>
<pre class="r"><code># creamos escala discreta
str(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    50 obs. of  4 variables:
##  $ lat  : num  38.5 39.4 40.2 39.2 38.8 ...
##  $ lng  : num  1.143 0.561 1.761 2.86 0.233 ...
##  $ size : num  11.22 19.63 5.72 10.61 10.21 ...
##  $ color: Factor w/ 50 levels &quot;azure1&quot;,&quot;cornsilk4&quot;,..: 4 8 29 33 40 27 14 7 3 25 ...</code></pre>
<pre class="r"><code># creamos un factor sobre el valor size con 3 cortes de valores
df$tamano&lt;-cut(df$size,3)

# Creo una escala discreta
pal &lt;- colorFactor(palette = c(&quot;red&quot;, &quot;blue&quot;, &quot;#9b4a11&quot;), 
                   levels = levels(df$tamano))
# pinto el mapa con leaflet
 leaflet(df) %&gt;% 
        addProviderTiles(providers$Stamen.Terrain) %&gt;% 
        addCircleMarkers(radius = 5,
                         color = ~pal(tamano),
                         popup = ~paste0(&quot;Tamano=&quot;, &quot;&lt;br/&gt;&quot;, signif(size,2))) %&gt;%
    addLegend(position = &quot;bottomright&quot;,
              title = &quot;Leyenda dato&quot;,
              pal = pal, 
              values = levels(df$tamano))</code></pre>
<div id="htmlwidget-12" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-12">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.Terrain",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],5,null,null,{"interactive":true,"className":"","stroke":true,"color":["#0000FF","#9B4A11","#FF0000","#0000FF","#0000FF","#FF0000","#0000FF","#FF0000","#9B4A11","#FF0000","#9B4A11","#0000FF","#0000FF","#FF0000","#0000FF","#0000FF","#0000FF","#9B4A11","#9B4A11","#FF0000","#0000FF","#FF0000","#FF0000","#9B4A11","#9B4A11","#0000FF","#FF0000","#9B4A11","#0000FF","#9B4A11","#9B4A11","#FF0000","#0000FF","#FF0000","#0000FF","#0000FF","#9B4A11","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#9B4A11","#9B4A11","#0000FF","#FF0000","#9B4A11","#9B4A11","#FF0000","#9B4A11"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#0000FF","#9B4A11","#FF0000","#0000FF","#0000FF","#FF0000","#0000FF","#FF0000","#9B4A11","#FF0000","#9B4A11","#0000FF","#0000FF","#FF0000","#0000FF","#0000FF","#0000FF","#9B4A11","#9B4A11","#FF0000","#0000FF","#FF0000","#FF0000","#9B4A11","#9B4A11","#0000FF","#FF0000","#9B4A11","#0000FF","#9B4A11","#9B4A11","#FF0000","#0000FF","#FF0000","#0000FF","#0000FF","#9B4A11","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#9B4A11","#9B4A11","#0000FF","#FF0000","#9B4A11","#9B4A11","#FF0000","#9B4A11"],"fillOpacity":0.2},null,null,["Tamano=<br/>11","Tamano=<br/>20","Tamano=<br/>5.7","Tamano=<br/>11","Tamano=<br/>10","Tamano=<br/>5.9","Tamano=<br/>13","Tamano=<br/>8.9","Tamano=<br/>17","Tamano=<br/>5.1","Tamano=<br/>18","Tamano=<br/>15","Tamano=<br/>13","Tamano=<br/>6.7","Tamano=<br/>10","Tamano=<br/>13","Tamano=<br/>12","Tamano=<br/>19","Tamano=<br/>19","Tamano=<br/>5.9","Tamano=<br/>13","Tamano=<br/>6.9","Tamano=<br/>8.4","Tamano=<br/>16","Tamano=<br/>18","Tamano=<br/>13","Tamano=<br/>8.2","Tamano=<br/>20","Tamano=<br/>12","Tamano=<br/>15","Tamano=<br/>19","Tamano=<br/>8","Tamano=<br/>13","Tamano=<br/>8.6","Tamano=<br/>14","Tamano=<br/>15","Tamano=<br/>16","Tamano=<br/>10","Tamano=<br/>5.8","Tamano=<br/>12","Tamano=<br/>7.6","Tamano=<br/>6.5","Tamano=<br/>20","Tamano=<br/>18","Tamano=<br/>12","Tamano=<br/>9.4","Tamano=<br/>17","Tamano=<br/>18","Tamano=<br/>7.2","Tamano=<br/>19"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#9B4A11","#FF0000","#0000FF"],"labels":["(14.9,19.8]","(5.07,9.98]","(9.98,14.9]"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"factor","title":"Leyenda dato","extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<p>Si lo que queremos es añadir una escala continua usaremos <code>colorNUmeric()</code>.</p>
<pre class="r"><code># ejemplo de escala continua
  palcontinua &lt;- colorNumeric(palette = &quot;Reds&quot;, domain = df$size, reverse = TRUE)

      leaflet(df) %&gt;% 
      addProviderTiles(providers$Stamen.TonerLite)  %&gt;% 
      addCircleMarkers(radius = 7, color = ~palcontinua(size), label = ~size)  %&gt;%
      addLegend(title = &quot;Leyenda escala continua&quot;, pal = palcontinua, values = df$size,
            position = &quot;bottomright&quot;)</code></pre>
<div id="htmlwidget-13" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-13">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[38.530616607792,39.4041798592687,40.1769936502003,39.1902531994615,38.7647015279754,40.1325999188456,39.0172453457665,38.6390806760048,39.7568114038277,39.7345350180215,38.7096331867272,38.4889244062304,39.866870123547,39.7713696133315,38.2317321405358,39.1795198208386,39.947951876412,39.1626181487919,39.1183322801656,38.3984287206235,38.381599219658,38.8970842460151,38.686061555019,39.1922899085522,39.2460333275904,38.4917427719822,39.7797418722524,39.6669145174923,39.0887410073468,39.0976211163491,39.7285285274247,38.546145477524,39.0970140378528,38.0190657319725,39.8870532739289,38.8331520975548,39.627893761129,38.8491719468274,38.5248315884396,39.1819608678516,38.9442896995656,37.9249513069617,39.2606625434913,39.3235449566371,38.8043633309178,39.8572668553758,39.0040780170621,39.2161243002482,38.719283590409,39.1501559275247],[1.14286683163958,0.561479797960751,1.76103628981103,2.85980075358534,0.232686389337679,-1.23607185026553,0.597287082205018,0.525605293690907,-0.994617228582236,0.162995750600356,0.418247042263298,0.914865048143463,-0.267877937986576,-0.019637971009346,-0.636961381813249,-1.09263912895007,-0.24159625054347,-0.280874602080044,-0.398294461091226,0.100917888499824,1.94570530520281,-0.66477073307116,0.101981986427172,0.0067145803401956,-1.39208981683743,-0.887202456080347,0.517963150542015,-0.504979499421189,0.223656816946022,0.0918661565821425,0.517940242361363,1.20805404669974,-0.512156398629988,1.42084105967371,0.287365321520896,-1.19575102993379,0.713181032681868,0.404245884900009,1.42401852346592,-1.54413762186615,0.899322331827412,-1.2234146780379,0.0685544236065688,-0.264572553758622,0.722573800270683,2.09495960969364,0.0269365850424225,-0.739022948974936,-0.196606211975849,-0.772698002370643],7,null,null,{"interactive":true,"className":"","stroke":true,"color":["#F34D36","#FFF4EE","#7C0410","#EF3C2C","#E83529","#810511","#FC7252","#CD1B1E","#FED2BF","#67000D","#FEE6DA","#FD9B7C","#FC7757","#9C0C14","#E83529","#FC7D5C","#F86143","#FFEFE8","#FFF1EB","#800511","#FC7B5A","#A30E15","#C3161B","#FDC0A8","#FEDCCD","#FC7958","#BF151B","#FFF5F0","#FB6B4B","#FDA183","#FFF1EB","#BB141A","#FC7B5A","#C8171C","#FC8362","#FD9C7E","#FCBBA0","#E33027","#7F0411","#F96143","#B31218","#970B14","#FFF4EF","#FEDECF","#FB6B4B","#D72522","#FDC6AF","#FFE6DB","#AA1016","#FFF1EA"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#F34D36","#FFF4EE","#7C0410","#EF3C2C","#E83529","#810511","#FC7252","#CD1B1E","#FED2BF","#67000D","#FEE6DA","#FD9B7C","#FC7757","#9C0C14","#E83529","#FC7D5C","#F86143","#FFEFE8","#FFF1EB","#800511","#FC7B5A","#A30E15","#C3161B","#FDC0A8","#FEDCCD","#FC7958","#BF151B","#FFF5F0","#FB6B4B","#FDA183","#FFF1EB","#BB141A","#FC7B5A","#C8171C","#FC8362","#FD9C7E","#FCBBA0","#E33027","#7F0411","#F96143","#B31218","#970B14","#FFF4EF","#FEDECF","#FB6B4B","#D72522","#FDC6AF","#FFE6DB","#AA1016","#FFF1EA"],"fillOpacity":0.2},null,null,null,null,[11.223377941642,19.6328595723026,5.71982853347436,10.6063684192486,10.2139197709039,5.88530720211565,12.7723796560895,8.87009672238491,17.2385354840662,5.08370086085051,18.431931938976,14.6576230437495,13.0038190970663,6.66790442424826,10.2315872721374,13.2516196987126,12.0073909161147,19.2794757126831,19.4515955937095,5.85406580241397,13.1577588187065,6.86901625362225,8.39273026562296,16.3631292793434,17.7547640306875,13.0875566252507,8.19452905911021,19.7631755110342,12.4720203236211,14.9285961396527,19.4297500874382,8.01321066799574,13.1772913632449,8.58802084927447,13.5521590255667,14.7158980474342,16.0730439668987,9.9591490754392,5.8148604631424,12.0222547580488,7.61588331195526,6.52575292042457,19.6850629348774,17.8152578184381,12.4815084389411,9.36149287153967,16.6293689399026,18.4851197979879,7.18271016725339,19.4141908269376],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#67000D , #850612 6.24204313155049%, #BB141A 19.8665089088389%, #E33127 33.4909746861273%, #F86043 47.1154404634156%, #FC8D6C 60.739906240704%, #FCB99F 74.3643720179924%, #FEE1D3 87.9888377952808%, #FFF5F0 "],"labels":["6","8","10","12","14","16","18"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"numeric","title":"Leyenda escala continua","extra":{"p_1":0.0624204313155049,"p_n":0.879888377952808},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[37.9249513069617,40.1769936502003],"lng":[-1.54413762186615,2.85980075358534]}},"evals":[],"jsHooks":[]}</script>
<p>en el argumento palette poemos especificar el nombre de alguna de las paletas predefinidas del paquete <code>RColorBrewer</code>, para verlas:</p>
<pre class="r"><code>    # see http://colorbrewer2.org/ for interactive examples
    library(RColorBrewer)
    display.brewer.all()</code></pre>
<p><a href="#indice">Volver al índice</a></p>
</div>
<div id="leaflet.extras" class="section level1">
<h1>leaflet.extras</h1>
<p>leaflet.extras es una librería complementaria a Leaflet que aporta algunos <em>widget</em> (artilugios) interesantes como funciones de busqueda en el mapa.</p>
<pre class="r"><code>library(leaflet.extras)
library(htmltools) #a para htmlescape que limpia los datos de html

#Lee la capa restaurantes
restaurantes&lt;-st_read(&quot;../../static/capas/Restaurantes.kml&quot;)</code></pre>
<pre><code>## Reading layer `Restaurantes&#39; from data source `C:\R\publicaciones\enrdados\static\capas\Restaurantes.kml&#39; using driver `KML&#39;
## Simple feature collection with 35 features and 2 fields
## geometry type:  POINT
## dimension:      XYZ
## bbox:           xmin: -3.689788 ymin: 37.56571 xmax: 2.176187 ymax: 41.3794
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="r"><code># pinta el mapa con opcion de busqueda
leaflet(restaurantes) %&gt;%
    addProviderTiles(providers$Esri.WorldImagery) %&gt;% 
    addCircleMarkers(radius = 7, group=&quot;comida&quot;,
                     color =&quot;blue&quot;, label = ~htmlEscape(Name)) %&gt;%
     setView(lng = -1.128575, 
             lat = 37.984047, 
             zoom = 14)%&gt;%
  addSearchFeatures(targetGroups = &quot;comida&quot;)</code></pre>
<div id="htmlwidget-14" style="width:672px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-14">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.4172802616535,37.9881308171713,37.9812304746737,37.9864366438071,37.9452074586719,37.9387140016178,37.9951346125816,38.0110111232739,37.9847621014412,41.3794018746312,37.9868567049326,38.0069196467813,37.9832590222482,37.9844303709882,37.9843456732221,38.0008781278819,37.9870135416758,38.0079289922708,37.9974839655485,37.9731598067091,37.9775950871869,38.4945084470293,37.9939497303458,37.9833108238779,37.9955886184787,37.9854796207809,37.9774711114233,40.4608882429798,37.9943879527871,37.9842153770964,37.9861700356157,37.5657108437846,37.9867624282222,37.9904934494202,37.9837835846917],[-3.68978826571382,-1.12789728022818,-1.12016736470191,-1.12589886313114,-1.11052573593652,-1.14221331034635,-1.12216484560524,-1.15366367209025,-1.13380219191635,2.17618689478169,-1.12797396725475,-1.14749184487728,-1.12606794471152,-1.13061155049013,-1.13288038252665,-1.13877057500082,-1.1274289824691,-1.15069273576526,-1.13118649977277,-1.12798561010345,-1.13058049912516,-0.270125082255362,-1.12015054559576,-1.13058400201524,-1.1302319498858,-1.14834601907954,-1.13122198749566,-3.68723844308519,-1.14194017062699,-1.12782942267582,-1.12660550461113,-1.26181682912188,-1.13015587606709,-1.13104567234531,-1.13412848954506],7,null,"comida",{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":0.5,"fill":true,"fillColor":"blue","fillOpacity":0.2},null,null,null,null,["Viridiana","Bambino","Quesería Tope","La sidrería escondida","Jazzazza","La Ermita","Da Lucio","La Salica","ZAHER","La Fonda","La Cueva del oso","Del Gallo Blues","La Parranda (nueva)","Casa Carmelina","Gran Bar","Tei","El Candil","Rincón de Lola","La Provençale","La Cancela","La Papa","Restaurante El Emperador","Limon i sal","El Tornasol","SONAMU","Chez Marcel","La Alhambra","Sacha","Tokio","Temporaneo","Alambique","La Taberna de la Tita","Fontana","Casa Portillo","Plaza de abastos de Verónicas"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addSearchFeatures","args":["comida",{"openPopup":false,"url":"","propertyLoc":"loc","propertyName":"label","moveToLocation":true,"zoom":17,"container":"","minLength":1,"initial":false,"casesensitive":false,"autoType":true,"delayType":400,"tooltipLimit":-1,"tipAutoSubmit":true,"firstTipSubmit":false,"autoResize":true,"collapsed":true,"autoCollapse":false,"autoCollapseTime":1200,"textErr":"Location Not Found","textCancel":"Cancel","textPlaceholder":"Search...","position":"topleft","hideMarkerOnCollapse":false}]}],"limits":{"lat":[37.5657108437846,41.3794018746312],"lng":[-3.68978826571382,2.17618689478169]},"setView":[[37.984047,-1.128575],14,[]]},"evals":[],"jsHooks":[]}</script>
<p>Podemos decirle que busque en un grupo determinado con el parametro tagetGruop y además indicar opciones como el zoom</p>
<p><a href="#indice">Volver al índice</a></p>
</div>
