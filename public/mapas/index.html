<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>R Mapas</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta name="generator" content="Hugo 0.53" />
	<meta property="og:title" content="R Mapas" />
<meta property="og:description" content="Chuleta rápida para hacer mapas con R Olga está conmigo
enlaces recomendados para mapeo con R  https://geocompr.robinlovelace.net/intro.html hoja resumen a imprimirse siempre ejemplos devarias librerias https://paleolimbot.github.io/ggspatial/  Crear mapa estático El objetivo es crear un mapa estático, en imagen, y representar varios puntos de coordenadas. Usaremos la librería ggspatial que es una versión de ggplot especial para hacer mapas con base de mapas libres, como los osm de openlayer." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/mapas/" /><meta property="article:published_time" content="2018-04-09T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-04-09T00:00:00&#43;00:00"/>

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
<link rel="stylesheet" href="/css/hybrid.css" rel="stylesheet" id="theme-stylesheet">
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="En_R_dados" rel="home">
				<div class="logo__title">En_R_dados</div>
				<div class="logo__tagline">Hablamos de R, red y otras cosas...</div>
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menú</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">About Hugo</a>
		</li>
		<li class="menu__item menu__item--active">
			<a class="menu__link" href="/mapas/">R Mapas</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">Sobre mi</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">R Mapas</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 16 16"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
	<time class="meta__text" datetime="2018-04-09T00:00:00">2018-04-09</time>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Índice</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li><a href="#chuleta-rápida-para-hacer-mapas-con-r">Chuleta rápida para hacer mapas con R</a>
<ul>
<li><a href="#enlaces-recomendados-para-mapeo-con-r">enlaces recomendados para mapeo con R</a></li>
<li><a href="#crear-mapa-estático">Crear mapa estático</a></li>
<li><a href="#preattymap">preattymap</a></li>
<li><a href="#ejemplo-sencillo-de-mapa-fondo-con-plot">Ejemplo sencillo de mapa fondo con plot</a></li>
<li><a href="#pintar-posicion-de-fotografías">pintar posicion de fotografías</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			

<h1 id="chuleta-rápida-para-hacer-mapas-con-r">Chuleta rápida para hacer mapas con R</h1>

<p>Olga está conmigo</p>

<h2 id="enlaces-recomendados-para-mapeo-con-r">enlaces recomendados para mapeo con R</h2>

<ul>
<li><a href="https://geocompr.robinlovelace.net/intro.html">https://geocompr.robinlovelace.net/intro.html</a></li>
<li><a href="https://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html">hoja resumen a imprimirse siempre</a></li>
<li><a href="https://bhaskarvk.github.io/user2017.geodataviz/notebooks/02-Static-Maps.nb.html">ejemplos devarias librerias</a></li>
<li><a href="https://paleolimbot.github.io/ggspatial/">https://paleolimbot.github.io/ggspatial/</a></li>
</ul>

<h2 id="crear-mapa-estático">Crear mapa estático</h2>

<p>El objetivo es crear un mapa estático, en imagen, y representar varios puntos de coordenadas.
Usaremos la librería <em>ggspatial</em> que es una versión de ggplot especial para hacer mapas con base de mapas libres, como los osm de openlayer.</p>

<p>Los datos que usaremos de entrada son coordenadas de dos puntos de la ciudad de Torrevieja, Alicante.
Las funciones de ggspatial son dos una <code>ggosm()</code> pinta mapas con base, pero es más interesante usar la funcion <code>ggplot</code> habitual y añadir como una geometría más el tipo de fondo mediante la fucnión <code>geom_osm</code> que se usa siempre dentro de <code>ggplot</code> .</p>

<p>Fondos libres o bases cartográficas que podemos usar son la mismas que las definidas en la función <code>osm.types()</code> de la librería <code>rosm</code>:</p>

<ul>
<li>&ldquo;osm&rdquo;</li>
<li>&ldquo;opencycle&rdquo;</li>
<li>&ldquo;hotstyle&rdquo;</li>
<li>&ldquo;loviniahike&rdquo;</li>
<li>&ldquo;loviniacycle&rdquo;</li>
<li>&ldquo;hikebike&rdquo;</li>
<li>&ldquo;osmgrayscale&rdquo;</li>
<li>&ldquo;stamenbw&rdquo;</li>
<li>&ldquo;stamenwatercolor&rdquo;</li>
<li>&ldquo;osmtransport&rdquo;</li>
<li>&ldquo;thunderforestlandscape&rdquo;</li>
<li>&ldquo;thunderforestoutdoors&rdquo;</li>
<li>&ldquo;cartodark&rdquo;</li>
<li>&ldquo;cartolight&rdquo;</li>
</ul>

<p>Veamos un ejemplo</p>

<pre><code class="language-r">suppressPackageStartupMessages(library(sp))
#library(sp)
library(ggplot2)
library(ggspatial)


## Creamos capa de puntos como data frame
torrevieja &lt;- data.frame(lon = c(-0.69,-0.67), lat = c(37.98,37.97))
# Convertimos la  tabla de puntos en capa espacial con sp
capa_puntos&lt;-SpatialPoints(torrevieja)
str(capa_puntos)
# Pintamos el mapa generico que se define con las coordenadas anteriroes
# pero no pinta los puntos
ggosm(capa_puntos) + ggtitle(&quot;Plano Torrevieja&quot;)

# Pintamos el mapa con los puntos

ggosm(type = &quot;osm&quot;) +  # pinta el mapa base
    ggtitle(&quot;Plano Torrevieja con puntos de interés&quot;)+
    geom_spatial(capa_puntos,size = 4, col=&quot;red&quot;,alpha = 0.6,lty = 2)+# pinta los puntos
    coord_map() # pinta leyenda 

# la funcion ggosm es igual a geom_osm
ggplot(capa_puntos)+
    geom_osm(type = &quot;stamenwatercolor&quot;)+  # pinta el mapa base
    ggtitle(&quot;Plano Torrevieja con puntos de interés y escala&quot;)+
    geom_spatial(capa_puntos,size = 5, col=&quot;blue&quot;,alpha = 0.3)+# pinta los puntos
    annotation_scale() # pinta leyenda 

</code></pre>

<h2 id="preattymap">preattymap</h2>

<pre><code class="language-r">#install.packages(&quot;prettymapr&quot;)
library(prettymapr)
library(rosm)
# source=&quot;dsk&quot; to use the Data Science Toolkit que evita tener que darse de alta en las APIs
prettymap(osm.plot(searchbbox(&quot;Murcia&quot;)),source=&quot;dsk&quot;)

# plano con puntos a mano
torrevieja &lt;- data.frame(lon = c(-0.69,-0.67), lat = c(37.98,37.97))

prettymap({
  osm.plot(searchbbox(&quot;Torrevieja&quot;),zoom=13)
  osm.points(torrevieja$lon, torrevieja$lat, pch=18, cex=2)
},scale.pos = &quot;topleft&quot;,
 arrow.pos=&quot;topright&quot;,
 drawarrow=T,arrow.scale=0.5,
 source=&quot;dsk&quot;)

</code></pre>

<h2 id="ejemplo-sencillo-de-mapa-fondo-con-plot">Ejemplo sencillo de mapa fondo con plot</h2>

<p>Mapa sencillo con prettymapr</p>

<pre><code class="language-r">
library(prettymapr)
torrevieja &lt;- data.frame(lon = c(-0.69,-0.67), lat = c(37.98,37.97))
# crea una caja de pintar makebbox(norte lat, este lon, sur lat, west lon)
#cajamapa &lt;- makebbox(max(torrevieja$lat),max(torrevieja$lon),min(torrevieja$lat),min(torrevieja$lon))
cajamapa &lt;- makebbox(37.98,-0.67,37.97,-0.69)

osm.plot(cajamapa, type=&quot;stamenbw&quot;)
prettymap(osm.plot(cajamapa, type=&quot;osmtransport&quot;), scale.style=&quot;ticks&quot;, scale.tick.cex=0)

</code></pre>

<h2 id="pintar-posicion-de-fotografías">pintar posicion de fotografías</h2>

<p>Vamos a leer los datos EFIX de unas fotos y pinta la posición de las mismas en una mapa estático.</p>

<pre><code class="language-r"># cargamos librería que leer exif
library(exifr)

# cargamos una lista con las imagenes
# ojo que es sensible a mayusculas o minusculas
imagenes &lt;- list.files(&quot;imag/&quot;, pattern = &quot;*.jpg&quot;,full.names=TRUE,ignore.case = T)
dat &lt;- exifr(imagenes)
str(dat)

library(dplyr)
# seleccionamos la columnas justas
dat2 &lt;- select(dat,
    GPSLongitude, GPSLatitude)
# pintamos los puntos de posicion de las fotos
plot(dat2$GPSLongitude, dat2$GPSLatitude)

# pintamos con fondo
#capap&lt;-SpatialPointsDataFrame(dat2, dat[,&quot;ModifyDate&quot;])

require(sf)
capap &lt;- st_as_sf(x = dat2, 
                        coords = c(&quot;GPSLongitude&quot;, &quot;GPSLatitude&quot;),
                        crs = &quot;+proj=longlat +datum=WGS84&quot;)
#plot(capap)
#str(capap@data)
# esto es porque da problemas con otros nombres
#names(capap@data)&lt;-c(&quot;x&quot;,&quot;y&quot;)

library(ggplot2)
library(ggspatial)
# la funcion ggosm es igual a geom_osm
ggplot(capap)+
    geom_osm(type = &quot;stamenwatercolor&quot;)+  # pinta el mapa base
    ggtitle(&quot;Plano Torrevieja con puntos de interés y escala&quot;)+
    geom_spatial(capap,size = 5, col=&quot;blue&quot;,alpha = 0.3)+
geom_text(aes(x=dat2$GPSLongitude, y=dat2$GPSLatitude, label = dat[,&quot;FileName&quot;]), size=3, col=&quot;blue&quot;)+ 
    annotation_scale()

# pinta los puntos
    geom_text(aes(x=capap$GPSLongitude+0.002, y = capap$GPSLatitude, label = dat[,&quot;FileName&quot;]), size=3, col=&quot;blue&quot;)+ 
    annotation_scale() # pinta leyenda 
str(capap)
# otros graficos
#caja&lt;-bbox(capap) # no funciona no se por qué
caja&lt;-sp::bbox(cbind(dat2$GPSLongitude, dat2$GPSLatitude))

#osm.plot(caja)

prettymap({
  osm.plot(caja, type=&quot;osm&quot;)
  osm.points(dat2$GPSLongitude, dat2$GPSLatitude, pch=18, cex=2)
},scale.pos = &quot;topleft&quot;,
 arrow.pos=&quot;topright&quot;,
 drawarrow=T,arrow.scale=0.5,
 source=&quot;dsk&quot;)


</code></pre>

		</div>
		
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="F.Vilber avatar" src="/img/gritos.png" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">Sobre el autor F.Vilber</span>
	</div>
	<div class="authorbox__description">
		F.VilBer true identity is unknown. Maybe he is a successful blogger or writer. Nobody knows it.
	</div>
</div>



			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="Buscar..." value="" name="q" aria-label="Buscar...">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="/" />
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Más Recientes</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/post/editar-pdf-a-dos-columnas/">Doc a 2 columnas</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/crear-un-blog-con-blogdown-2/">Crear un blog con blogdown (2)</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/crear-un-blog-con-blogdown-1/">Crear un blog con blogdown (1)</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/basic-elements/">Basic HTML Elements</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/mathjax/">MathJax</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categorías</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/categories/blog">Blog</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/bookdown">Bookdown</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/development">Development</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/edicion">Edicion</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/r">R</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Etiquetas</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/basic-elements" title="Basic elements">Basic elements</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/blogdown" title="Blogdown">Blogdown</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/css" title="Css">Css</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/html" title="Html">Html</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/mathjax" title="Mathjax">Mathjax</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pdf-columna-r-bookdown" title="Pdf columna r bookdown">Pdf columna r bookdown</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/r" title="R">R</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 En_R_dados.
			<span class="footer__copyright-credits">Generado con <a href="https://bookdown.org/yihui/blogdown/" rel="nofollow noopener" target="_blank">Blogdown</a>,  <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> y <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a>.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script></body>
</html>